/*! For license information please see admin.js.LICENSE.txt */
(()=>{var e={24:(e,t,a)=>{var n=a(163),r=a(110),i=a(996),s=a(312),o=a(166),l=a(766),m=a(760);function u(){"use strict";var t=r(),a=t.m(u),c=(Object.getPrototypeOf?Object.getPrototypeOf(a):a.__proto__).constructor;function p(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===c||"GeneratorFunction"===(t.displayName||t.name))}var d={throw:1,return:2,break:3,continue:3};function h(e){var t,a;return function(n){t||(t={stop:function(){return a(n.a,2)},catch:function(){return n.v},abrupt:function(e,t){return a(n.a,d[e],t)},delegateYield:function(e,r,i){return t.resultName=r,a(n.d,m(e),i)},finish:function(e){return a(n.f,e)}},a=function(e,a,r){n.p=t.prev,n.n=t.next;try{return e(a,r)}finally{t.next=n.n}}),t.resultName&&(t[t.resultName]=n.v,t.resultName=void 0),t.sent=n.v,t.next=n.n;try{return e.call(this,t)}finally{n.p=t.prev,n.n=t.next}}}return(e.exports=u=function(){return{wrap:function(e,a,n,r){return t.w(h(e),a,n,r&&r.reverse())},isGeneratorFunction:p,mark:t.m,awrap:function(e,t){return new n(e,t)},AsyncIterator:o,async:function(e,t,a,n,r){return(p(t)?s:i)(h(e),t,a,n,r)},keys:l,values:m}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports},110:(e,t,a)=>{var n=a(397);function r(){var t,a,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.toStringTag||"@@toStringTag";function l(e,r,i,s){var o=r&&r.prototype instanceof u?r:u,l=Object.create(o.prototype);return n(l,"_invoke",function(e,n,r){var i,s,o,l=0,u=r||[],c=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,a){return i=e,s=0,o=t,p.n=a,m}};function d(e,n){for(s=e,o=n,a=0;!c&&l&&!r&&a<u.length;a++){var r,i=u[a],d=p.p,h=i[2];e>3?(r=h===n)&&(o=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=d&&((r=e<2&&d<i[1])?(s=0,p.v=n,p.n=i[1]):d<h&&(r=e<3||i[0]>n||n>h)&&(i[4]=e,i[5]=n,p.n=h,s=0))}if(r||e>1)return m;throw c=!0,n}return function(r,u,h){if(l>1)throw TypeError("Generator is already running");for(c&&1===u&&d(u,h),s=u,o=h;(a=s<2?t:o)||!c;){i||(s?s<3?(s>1&&(p.n=-1),d(s,o)):p.n=o:p.v=o);try{if(l=2,i){if(s||(r="next"),a=i[r]){if(!(a=a.call(i,o)))throw TypeError("iterator result is not an object");if(!a.done)return a;o=a.value,s<2&&(s=0)}else 1===s&&(a=i.return)&&a.call(i),s<2&&(o=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=t}else if((a=(c=p.n<0)?o:e.call(n,p))!==m)break}catch(e){i=t,s=1,o=e}finally{l=1}}return{value:a,done:c}}}(e,i,s),!0),l}var m={};function u(){}function c(){}function p(){}a=Object.getPrototypeOf;var d=[][s]?a(a([][s]())):(n(a={},s,function(){return this}),a),h=p.prototype=u.prototype=Object.create(d);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,n(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=p,n(h,"constructor",p),n(p,"constructor",c),c.displayName="GeneratorFunction",n(p,o,"GeneratorFunction"),n(h),n(h,o,"Generator"),n(h,s,function(){return this}),n(h,"toString",function(){return"[object Generator]"}),(e.exports=r=function(){return{w:l,m:f}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},163:e=>{e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},166:(e,t,a)=>{var n=a(163),r=a(397);e.exports=function e(t,a){function i(e,r,s,o){try{var l=t[e](r),m=l.value;return m instanceof n?a.resolve(m.v).then(function(e){i("next",e,s,o)},function(e){i("throw",e,s,o)}):a.resolve(m).then(function(e){l.value=e,s(l)},function(e){return i("throw",e,s,o)})}catch(e){o(e)}}var s;this.next||(r(e.prototype),r(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),r(this,"_invoke",function(e,t,n){function r(){return new a(function(t,a){i(e,n,t,a)})}return s=s?s.then(r,r):r()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},183:(e,t,a)=>{var n=a(24)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},312:(e,t,a)=>{var n=a(110),r=a(166);e.exports=function(e,t,a,i,s){return new r(n().w(e,t,a,i),s||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},397:e=>{function t(a,n,r,i){var s=Object.defineProperty;try{s({},"",{})}catch(a){s=0}e.exports=t=function(e,a,n,r){function i(a,n){t(e,a,function(e){return this._invoke(a,n,e)})}a?s?s(e,a,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[a]=n:(i("next",0),i("throw",1),i("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(a,n,r,i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},735:e=>{function t(a){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},760:(e,t,a)=>{var n=a(735).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}throw new TypeError(n(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},766:e=>{e.exports=function(e){var t=Object(e),a=[];for(var n in t)a.unshift(n);return function e(){for(;a.length;)if((n=a.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},996:(e,t,a)=>{var n=a(312);e.exports=function(e,t,a,r,i){var s=n(e,t,a,r,i);return s.next().then(function(e){return e.done?e.value:s.next()})},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=flarum.core.compat["admin/app"];var t=a.n(e);const n=flarum.core.compat["common/extenders"];var r=a.n(n);const i=flarum.core.compat["common/Model"];var s=a.n(i);function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}var u=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).name=s().attribute("name"),t.slug=s().attribute("slug"),t.logoPath=s().attribute("logoPath"),t.logoUrl=s().attribute("logoUrl"),t}return l(t,e),t}(s()),c=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).name=s().attribute("name"),t.slug=s().attribute("slug"),t.startDate=s().attribute("startDate",s().transformDate),t.endDate=s().attribute("endDate",s().transformDate),t}return l(t,e),t}(s()),p=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).name=s().attribute("name"),t.seasonId=s().attribute("seasonId"),t.weekNumber=s().attribute("weekNumber"),t.season=s().hasOne("season"),t}return l(t,e),t}(s()),d=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).weekId=s().attribute("weekId"),t.homeTeamId=s().attribute("homeTeamId"),t.awayTeamId=s().attribute("awayTeamId"),t.matchDate=s().attribute("matchDate",s().transformDate),t.cutoffDate=s().attribute("cutoffDate",s().transformDate),t.allowDraw=s().attribute("allowDraw"),t.status=s().attribute("status"),t.homeScore=s().attribute("homeScore"),t.awayScore=s().attribute("awayScore"),t.result=s().attribute("result"),t.canPick=s().attribute("canPick"),t.week=s().hasOne("week"),t.homeTeam=s().hasOne("homeTeam"),t.awayTeam=s().hasOne("awayTeam"),t}return l(t,e),t}(s()),h=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).userId=s().attribute("userId"),t.eventId=s().attribute("eventId"),t.selectedOutcome=s().attribute("selectedOutcome"),t.isCorrect=s().attribute("isCorrect"),t.event=s().hasOne("event"),t.user=s().hasOne("user"),t}return l(t,e),t}(s()),f=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).userId=s().attribute("userId"),t.seasonId=s().attribute("seasonId"),t.totalPoints=s().attribute("totalPoints"),t.totalPicks=s().attribute("totalPicks"),t.correctPicks=s().attribute("correctPicks"),t.accuracy=s().attribute("accuracy"),t.user=s().hasOne("user"),t.season=s().hasOne("season"),t}return l(t,e),t}(s());const v=[(new(r().Store)).add("pickem-teams",u),new(r().Model)(u).attribute("name").attribute("slug").attribute("logoPath").attribute("logoUrl"),(new(r().Store)).add("pickem-seasons",c),new(r().Model)(c).attribute("name").attribute("slug").attribute("startDate",s().transformDate).attribute("endDate",s().transformDate),(new(r().Store)).add("pickem-weeks",p),new(r().Model)(p).attribute("name").attribute("seasonId").attribute("weekNumber").hasOne("season"),(new(r().Store)).add("pickem-events",d),new(r().Model)(d).attribute("weekId").attribute("homeTeamId").attribute("awayTeamId").attribute("matchDate",s().transformDate).attribute("cutoffDate",s().transformDate).attribute("allowDraw").attribute("status").attribute("homeScore").attribute("awayScore").attribute("result").attribute("canPick").hasOne("week").hasOne("homeTeam").hasOne("awayTeam"),(new(r().Store)).add("pickem-picks",h),new(r().Model)(h).attribute("userId").attribute("eventId").attribute("selectedOutcome").attribute("isCorrect").hasOne("event").hasOne("user"),(new(r().Store)).add("pickem-user-scores",f),new(r().Model)(f).attribute("userId").attribute("seasonId").attribute("totalPoints").attribute("totalPicks").attribute("correctPicks").attribute("accuracy").hasOne("user").hasOne("season")];function y(e,t,a,n,r,i,s){try{var o=e[i](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(n,r)}function b(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var i=e.apply(t,a);function s(e){y(i,n,r,s,o,"next",e)}function o(e){y(i,n,r,s,o,"throw",e)}s(void 0)})}}var g=a(183),k=a.n(g);const w=flarum.core.compat["admin/components/ExtensionPage"];var N=a.n(w);const z=flarum.core.compat["common/components/LoadingIndicator"];var x=a.n(z);const T=flarum.core.compat["common/components/Alert"];var D=a.n(T);const S=flarum.core.compat["common/Component"];var _=a.n(S);const I=flarum.core.compat["common/components/Button"];var C=a.n(I);const F=flarum.core.compat["common/components/Modal"];var L=a.n(F);const P=flarum.core.compat["common/utils/string"];var O=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).team=void 0,t.name="",t.slug="",t.logoPath="",t.loading=!1,t.uploadLoading=!1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.team=this.attrs.team,this.team&&(this.name=this.team.name()||"",this.slug=this.team.slug()||"",this.logoPath=this.team.logoPath()||"")},a.className=function(){return"TeamModal Modal--small"},a.title=function(){return this.team?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var e=this,t="fof-upload"in app.data.extensions;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(t){e.name=t.target.value,e.team||(e.slug=(0,P.slug)(e.name))}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.slug")),m("input",{className:"FormControl",type:"text",value:this.slug,oninput:function(t){e.slug=t.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.logo_url")),m("div",{style:{display:"flex",gap:"8px"}},m("input",{className:"FormControl",type:"text",value:this.logoPath,oninput:function(t){e.logoPath=t.target.value},placeholder:"https://example.com/logo.png",style:{flex:1}}),t&&m("[",null,m("input",{id:"pickem-logo-upload",type:"file",accept:"image/*",style:{display:"none"},onchange:this.handleUpload.bind(this)}),m(C(),{className:"Button Button--icon",icon:"fas fa-cloud-upload-alt",loading:this.uploadLoading,onclick:function(){var e=document.getElementById("pickem-logo-upload");e&&e.click()},title:"Upload with FoF Upload",type:"button"}))),this.logoPath&&m("div",{style:{marginTop:"10px"}},m("img",{src:this.logoPath,alt:"Logo preview",style:{maxWidth:"100px",maxHeight:"100px",border:"1px solid #ddd",padding:"5px",borderRadius:"4px"},onerror:function(e){e.target.style.display="none"}}))),m("div",{className:"Form-group"},m(C(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.handleUpload=function(){var e=b(k().mark(function e(t){var a,n,r,i,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t.target).files&&0!==a.files.length){e.next=1;break}return e.abrupt("return");case 1:return n=a.files[0],(r=new FormData).append("files[]",n),this.uploadLoading=!0,m.redraw(),e.prev=2,e.next=3,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/fof/upload",body:r,serialize:function(e){return e}});case 3:(i=e.sent)&&i.data&&i.data[0]&&i.data[0].attributes&&(this.logoPath=i.data[0].attributes.url,app.alerts.show({type:"success"},app.translator.trans("huseyinfiliz-pickem.lib.messages.saved"))),e.next=5;break;case 4:e.prev=4,s=e.catch(2),console.error("Logo upload failed:",s),app.alerts.show({type:"error"},"Upload failed. Check console for details.");case 5:return e.prev=5,this.uploadLoading=!1,a.value="",m.redraw(),e.finish(5);case 6:case"end":return e.stop()}},e,this,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}(),a.onsubmit=function(){var e=b(k().mark(function e(t){var a,n,r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,slug:this.slug,logoPath:this.logoPath},e.prev=1,n=this.team?this.team.save(a):app.store.createRecord("pickem-teams").save(a),e.next=2,n;case 2:this.attrs.onsave(),this.hide(),e.next=4;break;case 3:e.prev=3,r=e.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return e.stop()}},e,this,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),t}(L());const B=flarum.core.compat["common/utils/extractText"];var M=a.n(B),A=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var a=t.prototype;return a.view=function(){var e=this,t=app.store.all("pickem-teams");return m("div",{className:"TeamsTab"},m("div",{className:"TeamsTab-header"},m("h3",null,m("i",{className:"fas fa-users"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.teams")),m(C(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(O,{team:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.logo")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")),m("div",null)),t.map(function(t){return m("div",{key:t.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.logo")},e.renderTeamLogo(t)),m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},t.name()),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")},t.slug()),m("div",{className:"CardList-item-actions"},m(C(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(O,{team:t,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(C(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return e.deleteTeam(t)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.renderTeamLogo=function(e){var t=e.logoUrl(),a=e.name(),n=a?a.charAt(0).toUpperCase():"T",r=function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return"hsl("+t%360+", 65%, 50%)"}(a||"Team");return t?m("img",{src:t,alt:a||"Team",className:"TeamLogo TeamLogo--image"}):m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.deleteTeam=function(e){var t=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(t)&&e.delete().then(function(){m.redraw()})},t}(_()),E=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).season=void 0,t.name="",t.slug="",t.startDate="",t.endDate="",t.loading=!1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.season=this.attrs.season,this.season&&(this.name=this.season.name()||"",this.slug=this.season.slug()||"",this.startDate=this.formatDateForInput(this.season.startDate()),this.endDate=this.formatDateForInput(this.season.endDate()))},a.formatDateForInput=function(e){return e?new Date(e).toISOString().slice(0,10):""},a.className=function(){return"SeasonModal Modal--small"},a.title=function(){return this.season?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var e=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(t){e.name=t.target.value,e.season||(e.slug=(0,P.slug)(e.name))}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.slug")),m("input",{className:"FormControl",type:"text",value:this.slug,oninput:function(t){e.slug=t.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.start_date")),m("input",{className:"FormControl",type:"date",value:this.startDate,oninput:function(t){e.startDate=t.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.end_date")),m("input",{className:"FormControl",type:"date",value:this.endDate,oninput:function(t){e.endDate=t.target.value}})),m("div",{className:"Form-group"},m(C(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var e=b(k().mark(function e(t){var a,n,r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,slug:this.slug,startDate:this.startDate||null,endDate:this.endDate||null},e.prev=1,n=this.season?this.season.save(a):app.store.createRecord("pickem-seasons").save(a),e.next=2,n;case 2:this.attrs.onsave(),this.hide(),e.next=4;break;case 3:e.prev=3,r=e.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return e.stop()}},e,this,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),t}(L()),j=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var a=t.prototype;return a.view=function(){var e=this,t=app.store.all("pickem-seasons");return m("div",{className:"SeasonsTab"},m("div",{className:"SeasonsTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-alt"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.seasons")),m(C(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(E,{season:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.date")),m("div",null)),0===t.length?m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_data"))):t.map(function(t){return m("div",{key:t.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},t.name()),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")},t.slug()),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.date")},t.startDate()&&t.endDate()?m("span",null,new Date(t.startDate()).toLocaleDateString()," - ",new Date(t.endDate()).toLocaleDateString()):"-"),m("div",{className:"CardList-item-actions"},m(C(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(E,{season:t,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(C(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return e.deleteSeason(t)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.deleteSeason=function(e){var t=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(t)&&e.delete().then(function(){m.redraw()})},t}(_());const U=flarum.core.compat["common/components/Select"];var G=a.n(U),R=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).week=void 0,t.name="",t.weekNumber="",t.seasonId="0",t.loading=!1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.week=this.attrs.week,this.week&&(this.name=this.week.name()||"",this.weekNumber=this.week.weekNumber()||"",this.seasonId=this.week.seasonId()||"0")},a.className=function(){return"WeekModal Modal--small"},a.title=function(){return this.week?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var e=this,t=app.store.all("pickem-seasons").reduce(function(e,t){return e[t.id()]=t.name(),e},{});return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(t){e.name=t.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m(G(),{className:"FormControl",value:this.seasonId,onchange:function(t){e.seasonId=t},options:t,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_season")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.week_number")),m("input",{className:"FormControl",type:"number",value:this.weekNumber,oninput:function(t){e.weekNumber=t.target.value}})),m("div",{className:"Form-group"},m(C(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var e=b(k().mark(function e(t){var a,n,r;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,weekNumber:this.weekNumber||null,seasonId:"0"===this.seasonId?null:this.seasonId},e.prev=1,n=this.week?this.week.save(a):app.store.createRecord("pickem-weeks").save(a),e.next=2,n;case 2:this.attrs.onsave(),this.hide(),e.next=4;break;case 3:e.prev=3,r=e.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return e.stop()}},e,this,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),t}(L()),q=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var a=t.prototype;return a.view=function(){var e=this,t=app.store.all("pickem-weeks");return m("div",{className:"WeeksTab"},m("div",{className:"WeeksTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-week"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.weeks")),m(C(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(R,{week:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.week_number")),m("div",null)),0===t.length?m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_data"))):t.map(function(t){var a=t.season();return m("div",{key:t.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},t.name()),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.season")},a?a.name():"-"),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.week_number")},t.weekNumber()),m("div",{className:"CardList-item-actions"},m(C(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(R,{week:t,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(C(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return e.deleteWeek(t)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.deleteWeek=function(e){var t=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(t)&&e.delete().then(function(){m.redraw()})},t}(_()),W=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).event=void 0,t.homeTeamId="0",t.awayTeamId="0",t.weekId="0",t.matchDate="",t.cutoffDate="",t.allowDraw=!1,t.status="scheduled",t.loading=!1,t.homeTeamFilter="",t.awayTeamFilter="",t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.event=this.attrs.event,this.event&&(this.homeTeamId=this.event.homeTeamId()||"0",this.awayTeamId=this.event.awayTeamId()||"0",this.weekId=this.event.weekId()||"0",this.matchDate=this.formatDateForInput(this.event.matchDate()),this.cutoffDate=this.formatDateForInput(this.event.cutoffDate()),this.allowDraw=this.event.allowDraw()||!1,this.status=this.event.status()||"scheduled")},a.formatDateForInput=function(e){return e?e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+"T"+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0"):""},a.className=function(){return"EventModal Modal--medium"},a.title=function(){return this.event?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var e=this,t=app.store.all("pickem-teams"),a=app.store.all("pickem-weeks"),n=t.filter(function(t){var a;return null==(a=t.name())?void 0:a.toLowerCase().includes(e.homeTeamFilter.toLowerCase())});if("0"!==this.homeTeamId&&!n.find(function(t){return t.id()===e.homeTeamId})){var r=t.find(function(t){return t.id()===e.homeTeamId});r&&n.unshift(r)}var i=n.reduce(function(e,t){return e[t.id()]=t.name(),e},{}),s=t.filter(function(t){var a;return null==(a=t.name())?void 0:a.toLowerCase().includes(e.awayTeamFilter.toLowerCase())});if("0"!==this.awayTeamId&&!s.find(function(t){return t.id()===e.awayTeamId})){var o=t.find(function(t){return t.id()===e.awayTeamId});o&&s.unshift(o)}var l=s.reduce(function(e,t){return e[t.id()]=t.name(),e},{}),u=a.reduce(function(e,t){return e[t.id()]=t.name(),e},{});return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.week")),m(G(),{className:"FormControl",value:this.weekId,onchange:function(t){e.weekId=t},options:u,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.no_week")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.home_team")),m("input",{className:"FormControl",type:"text",placeholder:app.translator.trans("huseyinfiliz-pickem.lib.form.search_team"),value:this.homeTeamFilter,oninput:function(t){e.homeTeamFilter=t.target.value},style:"margin-bottom: 5px; font-size: 12px;"}),m(G(),{className:"FormControl",value:this.homeTeamId,onchange:function(t){e.homeTeamId=t},options:i,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_team")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.away_team")),m("input",{className:"FormControl",type:"text",placeholder:app.translator.trans("huseyinfiliz-pickem.lib.form.search_team"),value:this.awayTeamFilter,oninput:function(t){e.awayTeamFilter=t.target.value},style:"margin-bottom: 5px; font-size: 12px;"}),m(G(),{className:"FormControl",value:this.awayTeamId,onchange:function(t){e.awayTeamId=t},options:l,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_team")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")),m("input",{className:"FormControl",type:"datetime-local",value:this.matchDate,oninput:function(t){e.matchDate=t.target.value},required:!0})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.cutoff_date")),m("input",{className:"FormControl",type:"datetime-local",value:this.cutoffDate,oninput:function(t){e.cutoffDate=t.target.value},required:!0})),m("div",{className:"Form-group"},m("label",{className:"checkbox"},m("input",{type:"checkbox",checked:this.allowDraw,onchange:function(t){e.allowDraw=t.target.checked}}),app.translator.trans("huseyinfiliz-pickem.lib.form.allow_draw"))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m(G(),{className:"FormControl",value:this.status,onchange:function(t){e.status=t},options:{scheduled:app.translator.trans("huseyinfiliz-pickem.lib.status.scheduled"),closed:app.translator.trans("huseyinfiliz-pickem.lib.status.closed"),finished:app.translator.trans("huseyinfiliz-pickem.lib.status.finished")}})),m("div",{className:"Form-group"},m(C(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var e=b(k().mark(function e(t){var a,n,r,i,s;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.matchDate&&""!==this.matchDate.trim()){e.next=1;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),e.abrupt("return");case 1:if(this.cutoffDate&&""!==this.cutoffDate.trim()){e.next=2;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),e.abrupt("return");case 2:if("0"!==this.homeTeamId&&this.homeTeamId){e.next=3;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),e.abrupt("return");case 3:if("0"!==this.awayTeamId&&this.awayTeamId){e.next=4;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),e.abrupt("return");case 4:if(this.homeTeamId!==this.awayTeamId){e.next=5;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.same_team")),e.abrupt("return");case 5:return this.loading=!0,m.redraw(),a=new Date(this.matchDate).toISOString(),n=new Date(this.cutoffDate).toISOString(),r={weekId:"0"===this.weekId?null:parseInt(this.weekId),homeTeamId:parseInt(this.homeTeamId),awayTeamId:parseInt(this.awayTeamId),matchDate:a,cutoffDate:n,allowDraw:this.allowDraw,status:this.status},e.prev=6,i=this.event?this.event.save(r):app.store.createRecord("pickem-events").save(r),e.next=7,i;case 7:this.attrs.onsave(),this.hide(),e.next=9;break;case 8:e.prev=8,s=e.catch(6),this.loading=!1,this.alertAttrs=s.alert,m.redraw();case 9:case"end":return e.stop()}},e,this,[[6,8]])}));return function(t){return e.apply(this,arguments)}}(),t}(L()),H=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).event=void 0,t.homeScore="",t.awayScore="",t.loading=!1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.event=this.attrs.event,this.homeScore=null!==this.event.homeScore()?this.event.homeScore():"",this.awayScore=null!==this.event.awayScore()?this.event.awayScore():""},a.className=function(){return"ResultModal Modal--small"},a.title=function(){return app.translator.trans("huseyinfiliz-pickem.lib.actions.enter_result")},a.content=function(){var e=this,t=this.event.homeTeam(),a=this.event.awayTeam(),n="",r=Number(this.homeScore),i=Number(this.awayScore);return""!==this.homeScore&&""!==this.awayScore&&(n=r>i?t?t.name():app.translator.trans("huseyinfiliz-pickem.lib.common.home"):i>r?a?a.name():app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.draw")),m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("div",{className:"TeamCell",style:{marginBottom:"8px"}},this.renderTeamLogo(t),m("label",{style:{margin:0}},t?t.name():app.translator.trans("huseyinfiliz-pickem.lib.form.home_team"))),m("input",{className:"FormControl",type:"number",min:"0",value:this.homeScore,oninput:function(t){e.homeScore=t.target.value}})),m("div",{className:"Form-group"},m("div",{className:"TeamCell",style:{marginBottom:"8px"}},this.renderTeamLogo(a),m("label",{style:{margin:0}},a?a.name():app.translator.trans("huseyinfiliz-pickem.lib.form.away_team"))),m("input",{className:"FormControl",type:"number",min:"0",value:this.awayScore,oninput:function(t){e.awayScore=t.target.value}})),n&&m("div",{className:"Form-group"},m("p",null,m("strong",null,app.translator.trans("huseyinfiliz-pickem.lib.common.result"),": "),n)),m("div",{className:"Form-group"},m(C(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.renderTeamLogo=function(e){if(!e)return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:"#999"}},"?");var t=e.logoUrl(),a=e.name(),n=a?a.charAt(0).toUpperCase():"T";if(t)return m("img",{src:t,alt:a||"Team",className:"TeamLogo TeamLogo--image"});var r=function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return"hsl("+t%360+", 65%, 50%)"}(a||"Team");return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.onsubmit=function(){var e=b(k().mark(function e(t){var a,n;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.loading=!0,m.redraw(),e.prev=1,e.next=2,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/pickem-events/"+this.event.id()+"/result",body:{data:{type:"pickem-events",attributes:{homeScore:parseInt(this.homeScore)||0,awayScore:parseInt(this.awayScore)||0}}}});case 2:a=e.sent,app.store.pushPayload(a),app.alerts.show({type:"success"},app.translator.trans("huseyinfiliz-pickem.lib.messages.result_saved")),this.attrs.onsave(),this.hide(),e.next=4;break;case 3:e.prev=3,n=e.catch(1),this.loading=!1,this.alertAttrs=n.alert,m.redraw();case 4:case"end":return e.stop()}},e,this,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),t}(L()),Y=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).selectedSeason="all",t.selectedTeam="all",t.selectedStatus="all",t.sortOrder="desc",t.loading=!1,t.events=[],t.hasMore=!1,t.limit=20,t.page=1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.loadEvents(!0)},a.buildFilters=function(){var e=this,t={},a=[];if("all"!==this.selectedSeason){var n=app.store.all("pickem-weeks").filter(function(t){return t.seasonId()==e.selectedSeason});a.push.apply(a,n.map(function(e){return String(e.id())})),0===a.length&&a.push("0"),a.push("null"),t.week=a.join(",")}return"all"!==this.selectedTeam&&(t.team=this.selectedTeam),"all"!==this.selectedStatus&&(t.status=this.selectedStatus),t},a.loadEvents=function(e){var t=this;void 0===e&&(e=!1),this.loading=!0,m.redraw();var a=e?0:this.events.length,n=this.buildFilters(),r="desc"===this.sortOrder?"-matchDate":"matchDate";app.store.find("pickem-events",{include:"homeTeam,awayTeam,week",filter:n,sort:r,page:{limit:this.limit,offset:a}}).then(function(a){t.events=e?a:[].concat(t.events,a),t.hasMore=a.length>=t.limit,t.loading=!1,m.redraw()}).catch(function(e){t.loading=!1,console.error(e),m.redraw()})},a.view=function(){var e=this,t=app.store.all("pickem-seasons"),a=app.store.all("pickem-teams"),n=this.events.length>0,r="1"===app.data.settings["huseyinfiliz-pickem.reverse_display"];return m("div",{className:"EventsTab"},m("div",{className:"EventsTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-alt"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.matches")),m(C(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(W,{event:null,onsave:function(){return e.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"EventsTab-filters"},m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m("select",{value:this.selectedSeason,onchange:function(t){e.selectedSeason=t.target.value,e.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),t.map(function(e){return m("option",{key:e.id(),value:e.id()},e.name())}))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.team")),m("select",{value:this.selectedTeam,onchange:function(t){e.selectedTeam=t.target.value,e.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),a.map(function(e){return m("option",{key:e.id(),value:e.id()},e.name())}))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m("select",{value:this.selectedStatus,onchange:function(t){e.selectedStatus=t.target.value,e.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),m("option",{value:"scheduled"},app.translator.trans("huseyinfiliz-pickem.lib.status.scheduled")),m("option",{value:"closed"},app.translator.trans("huseyinfiliz-pickem.lib.status.closed")),m("option",{value:"finished"},app.translator.trans("huseyinfiliz-pickem.lib.status.finished")))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.filters.sort")),m("select",{value:this.sortOrder,onchange:function(t){e.sortOrder=t.target.value,e.loadEvents(!0)}},m("option",{value:"desc"},app.translator.trans("huseyinfiliz-pickem.lib.filters.newest")),m("option",{value:"asc"},app.translator.trans("huseyinfiliz-pickem.lib.filters.oldest"))))),n||this.loading?m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,r?app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.home")),m("div",null,r?app.translator.trans("huseyinfiliz-pickem.lib.common.home"):app.translator.trans("huseyinfiliz-pickem.lib.common.away")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.score")),m("div",null)),this.events.map(function(t){var a=t.homeTeam(),n=t.awayTeam();return m("div",{key:t.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":r?app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.home")},m("div",{className:"TeamCell"},e.renderTeamLogo(r?n:a),m("span",null,r?n?n.name():"N/A":a?a.name():"N/A"))),m("div",{className:"CardList-item-cell","data-label":r?app.translator.trans("huseyinfiliz-pickem.lib.common.home"):app.translator.trans("huseyinfiliz-pickem.lib.common.away")},m("div",{className:"TeamCell"},e.renderTeamLogo(r?a:n),m("span",null,r?a?a.name():"N/A":n?n.name():"N/A"))),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")},t.matchDate()?new Date(t.matchDate()).toLocaleString():"-"),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.status")},m("span",{className:"StatusBadge StatusBadge--"+t.status()},app.translator.trans("huseyinfiliz-pickem.lib.status."+t.status()))),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.score")},null!==t.homeScore()&&null!==t.awayScore()?r?t.awayScore()+" - "+t.homeScore():t.homeScore()+" - "+t.awayScore():"-"),m("div",{className:"CardList-item-actions"},m(C(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(W,{event:t,onsave:function(){return e.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(C(),{className:"Button Button--success",icon:"fas fa-check",onclick:function(){return app.modal.show(H,{event:t,onsave:function(){return e.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.enter_result")),m(C(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return e.deleteEvent(t)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})):m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_matches"))),this.loading&&m(x(),null),this.hasMore&&!this.loading&&m("div",{className:"LoadMore"},m(C(),{className:"Button Button--primary",onclick:function(){return e.loadEvents(!1)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.load_more"))))},a.renderTeamLogo=function(e){if(!e)return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:"#999"}},"?");var t=e.logoUrl(),a=e.name(),n=a?a.charAt(0).toUpperCase():"?";if(t)return m("img",{src:t,alt:a||"Team",className:"TeamLogo TeamLogo--image"});var r=function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return"hsl("+t%360+", 65%, 50%)"}(a||"Team");return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.deleteEvent=function(e){var t=this,a=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(a)&&e.delete().then(function(){t.loadEvents(!0)})},t}(_());const J=flarum.core.compat["common/components/Switch"];var K=a.n(J),Q=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).loading=!1,t.reverseDisplay=!1,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t),this.reverseDisplay="1"===app.data.settings["huseyinfiliz-pickem.reverse_display"]},a.view=function(){return m("div",{className:"SettingsTab"},m("div",{className:"Form-group"},m("h3",null,m("i",{className:"fas fa-cogs"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.settings")),m("div",{className:"Form-group"},m(K(),{state:this.reverseDisplay,onchange:this.toggleReverseDisplay.bind(this)},app.translator.trans("huseyinfiliz-pickem.admin.settings.reverse_display_label")),m("div",{className:"helpText"},app.translator.trans("huseyinfiliz-pickem.admin.settings.reverse_display_help"))),m("hr",null),m("p",null,app.translator.trans("huseyinfiliz-pickem.admin.settings.recalc_help")),m(C(),{className:"Button Button--primary",icon:"fas fa-sync",loading:this.loading,onclick:this.recalculateScores.bind(this)},app.translator.trans("huseyinfiliz-pickem.admin.settings.recalc_btn"))))},a.toggleReverseDisplay=function(e){this.reverseDisplay=e,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/settings",body:{"huseyinfiliz-pickem.reverse_display":e?"1":"0"}})},a.recalculateScores=function(){var e=this;this.loading||confirm(app.translator.trans("huseyinfiliz-pickem.admin.settings.recalc_confirm"))&&(this.loading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/pickem/recalculate-all-scores"}).then(function(t){e.loading=!1,m.redraw(),app.alerts.show({type:"success"},app.translator.trans("huseyinfiliz-pickem.admin.settings.recalc_queued"))}).catch(function(t){e.loading=!1,m.redraw(),console.error(t)}))},t}(_()),V=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).activeTab="events",t.loading=!0,t.error=null,t}l(t,e);var a=t.prototype;return a.oninit=function(t){e.prototype.oninit.call(this,t);var a=m.route.param("tab");a&&["events","teams","seasons","weeks","settings"].includes(a)&&(this.activeTab=a),this.loadData()},a.loadData=function(){var e=b(k().mark(function e(){var t;return k().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,Promise.all([app.store.find("pickem-teams"),app.store.find("pickem-seasons"),app.store.find("pickem-weeks",{include:"season"})]);case 1:this.error=null,e.next=3;break;case 2:e.prev=2,t=e.catch(0),console.error("Pickem admin data load error:",t),this.error=t.message||"An unknown error occurred while loading data.";case 3:return e.prev=3,this.loading=!1,m.redraw(),e.finish(3);case 4:case"end":return e.stop()}},e,this,[[0,2,3,4]])}));return function(){return e.apply(this,arguments)}}(),a.content=function(){var e;return e=this.loading?m("div",{className:"LoadingState"},m(x(),null)):this.error?m(D(),{type:"error"},this.error):this.renderTabContent(),m("div",{className:"PickemPage"},m("div",{className:"container"},m("div",{className:"PickemPage-tabs"},this.renderTab("events","fas fa-futbol",app.translator.trans("huseyinfiliz-pickem.lib.nav.matches")),this.renderTab("teams","fas fa-users",app.translator.trans("huseyinfiliz-pickem.lib.nav.teams")),this.renderTab("seasons","fas fa-calendar-alt",app.translator.trans("huseyinfiliz-pickem.lib.nav.seasons")),this.renderTab("weeks","fas fa-calendar-week",app.translator.trans("huseyinfiliz-pickem.lib.nav.weeks")),this.renderTab("settings","fas fa-cogs",app.translator.trans("huseyinfiliz-pickem.lib.nav.settings"))),m("div",{className:"PickemPage-content"},e)))},a.renderTab=function(e,t,a){var n=this,r=this.activeTab===e;return m("button",{className:"Button "+(r?"Button--primary":""),onclick:function(){n.activeTab=e;var t=m.route.get().split("?")[0];m.route.set(t,{tab:e},{replace:!0})}},m("i",{className:t})," ",m("span",null,a))},a.renderTabContent=function(){switch(this.activeTab){case"events":default:return m(Y,null);case"teams":return m(A,null);case"seasons":return m(j,null);case"weeks":return m(q,null);case"settings":return m(Q,null)}},t}(N());t().initializers.add("huseyinfiliz/pickem",function(){v.forEach(function(e){return e.extend(t())}),t().extensionData.for("huseyinfiliz-pickem").registerPage(V).registerPermission({icon:"fas fa-trophy",label:t().translator.trans("huseyinfiliz-pickem.admin.permissions.manage"),permission:"pickem.manage"},"moderate").registerPermission({icon:"fas fa-check-circle",label:t().translator.trans("huseyinfiliz-pickem.admin.permissions.make_picks"),permission:"pickem.makePicks"},"start").registerPermission({icon:"fas fa-eye",label:t().translator.trans("huseyinfiliz-pickem.admin.permissions.view_page"),permission:"pickem.view",allowGuest:!0},"view")})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map