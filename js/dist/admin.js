/*! For license information please see admin.js.LICENSE.txt */
(()=>{var t={24(t,e,a){var n=a(163),r=a(110),i=a(996),s=a(312),o=a(166),l=a(766),m=a(760);function u(){"use strict";var e=r(),a=e.m(u),c=(Object.getPrototypeOf?Object.getPrototypeOf(a):a.__proto__).constructor;function p(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===c||"GeneratorFunction"===(e.displayName||e.name))}var d={throw:1,return:2,break:3,continue:3};function h(t){var e,a;return function(n){e||(e={stop:function(){return a(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return a(n.a,d[t],e)},delegateYield:function(t,r,i){return e.resultName=r,a(n.d,m(t),i)},finish:function(t){return a(n.f,t)}},a=function(t,a,r){n.p=e.prev,n.n=e.next;try{return t(a,r)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(t.exports=u=function(){return{wrap:function(t,a,n,r){return e.w(h(t),a,n,r&&r.reverse())},isGeneratorFunction:p,mark:e.m,awrap:function(t,e){return new n(t,e)},AsyncIterator:o,async:function(t,e,a,n,r){return(p(e)?s:i)(h(t),e,a,n,r)},keys:l,values:m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=u,t.exports.__esModule=!0,t.exports.default=t.exports},110(t,e,a){var n=a(397);function r(){var e,a,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.toStringTag||"@@toStringTag";function l(t,r,i,s){var o=r&&r.prototype instanceof u?r:u,l=Object.create(o.prototype);return n(l,"_invoke",function(t,n,r){var i,s,o,l=0,u=r||[],c=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,a){return i=t,s=0,o=e,p.n=a,m}};function d(t,n){for(s=t,o=n,a=0;!c&&l&&!r&&a<u.length;a++){var r,i=u[a],d=p.p,h=i[2];t>3?(r=h===n)&&(o=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=d&&((r=t<2&&d<i[1])?(s=0,p.v=n,p.n=i[1]):d<h&&(r=t<3||i[0]>n||n>h)&&(i[4]=t,i[5]=n,p.n=h,s=0))}if(r||t>1)return m;throw c=!0,n}return function(r,u,h){if(l>1)throw TypeError("Generator is already running");for(c&&1===u&&d(u,h),s=u,o=h;(a=s<2?e:o)||!c;){i||(s?s<3?(s>1&&(p.n=-1),d(s,o)):p.n=o:p.v=o);try{if(l=2,i){if(s||(r="next"),a=i[r]){if(!(a=a.call(i,o)))throw TypeError("iterator result is not an object");if(!a.done)return a;o=a.value,s<2&&(s=0)}else 1===s&&(a=i.return)&&a.call(i),s<2&&(o=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((a=(c=p.n<0)?o:t.call(n,p))!==m)break}catch(t){i=e,s=1,o=t}finally{l=1}}return{value:a,done:c}}}(t,i,s),!0),l}var m={};function u(){}function c(){}function p(){}a=Object.getPrototypeOf;var d=[][s]?a(a([][s]())):(n(a={},s,function(){return this}),a),h=p.prototype=u.prototype=Object.create(d);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,n(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return c.prototype=p,n(h,"constructor",p),n(p,"constructor",c),c.displayName="GeneratorFunction",n(p,o,"GeneratorFunction"),n(h),n(h,o,"Generator"),n(h,s,function(){return this}),n(h,"toString",function(){return"[object Generator]"}),(t.exports=r=function(){return{w:l,m:f}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},163(t){t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},166(t,e,a){var n=a(163),r=a(397);t.exports=function t(e,a){function i(t,r,s,o){try{var l=e[t](r),m=l.value;return m instanceof n?a.resolve(m.v).then(function(t){i("next",t,s,o)},function(t){i("throw",t,s,o)}):a.resolve(m).then(function(t){l.value=t,s(l)},function(t){return i("throw",t,s,o)})}catch(t){o(t)}}var s;this.next||(r(t.prototype),r(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),r(this,"_invoke",function(t,e,n){function r(){return new a(function(e,a){i(t,n,e,a)})}return s=s?s.then(r,r):r()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183(t,e,a){var n=a(24)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},312(t,e,a){var n=a(110),r=a(166);t.exports=function(t,e,a,i,s){return new r(n().w(t,e,a,i),s||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397(t){function e(a,n,r,i){var s=Object.defineProperty;try{s({},"",{})}catch(a){s=0}t.exports=e=function(t,a,n,r){function i(a,n){e(t,a,function(t){return this._invoke(a,n,t)})}a?s?s(t,a,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[a]=n:(i("next",0),i("throw",1),i("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(a,n,r,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},735(t){function e(a){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(a)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},760(t,e,a){var n=a(735).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766(t){t.exports=function(t){var e=Object(t),a=[];for(var n in e)a.unshift(n);return function t(){for(;a.length;)if((n=a.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996(t,e,a){var n=a(312);t.exports=function(t,e,a,r,i){var s=n(t,e,a,r,i);return s.next().then(function(t){return t.done?t.value:s.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function a(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,a),i.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.core.compat["admin/app"];var e=a.n(t);const n=flarum.core.compat["common/extenders"];var r=a.n(n);const i=flarum.core.compat["common/Model"];var s=a.n(i);function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}var u=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).name=s().attribute("name"),e.slug=s().attribute("slug"),e.logoPath=s().attribute("logoPath"),e.logoUrl=s().attribute("logoUrl"),e}return l(e,t),e}(s()),c=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).name=s().attribute("name"),e.slug=s().attribute("slug"),e.startDate=s().attribute("startDate",s().transformDate),e.endDate=s().attribute("endDate",s().transformDate),e}return l(e,t),e}(s()),p=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).name=s().attribute("name"),e.seasonId=s().attribute("seasonId"),e.weekNumber=s().attribute("weekNumber"),e.season=s().hasOne("season"),e}return l(e,t),e}(s()),d=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).weekId=s().attribute("weekId"),e.homeTeamId=s().attribute("homeTeamId"),e.awayTeamId=s().attribute("awayTeamId"),e.matchDate=s().attribute("matchDate",s().transformDate),e.cutoffDate=s().attribute("cutoffDate",s().transformDate),e.allowDraw=s().attribute("allowDraw"),e.status=s().attribute("status"),e.homeScore=s().attribute("homeScore"),e.awayScore=s().attribute("awayScore"),e.result=s().attribute("result"),e.canPick=s().attribute("canPick"),e.week=s().hasOne("week"),e.homeTeam=s().hasOne("homeTeam"),e.awayTeam=s().hasOne("awayTeam"),e}return l(e,t),e}(s()),h=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).userId=s().attribute("userId"),e.eventId=s().attribute("eventId"),e.selectedOutcome=s().attribute("selectedOutcome"),e.isCorrect=s().attribute("isCorrect"),e.event=s().hasOne("event"),e.user=s().hasOne("user"),e}return l(e,t),e}(s()),f=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).userId=s().attribute("userId"),e.seasonId=s().attribute("seasonId"),e.totalPoints=s().attribute("totalPoints"),e.totalPicks=s().attribute("totalPicks"),e.correctPicks=s().attribute("correctPicks"),e.accuracy=s().attribute("accuracy"),e.user=s().hasOne("user"),e.season=s().hasOne("season"),e}return l(e,t),e}(s());const v=[(new(r().Store)).add("pickem-teams",u),new(r().Model)(u).attribute("name").attribute("slug").attribute("logoPath").attribute("logoUrl"),(new(r().Store)).add("pickem-seasons",c),new(r().Model)(c).attribute("name").attribute("slug").attribute("startDate",s().transformDate).attribute("endDate",s().transformDate),(new(r().Store)).add("pickem-weeks",p),new(r().Model)(p).attribute("name").attribute("seasonId").attribute("weekNumber").hasOne("season"),(new(r().Store)).add("pickem-events",d),new(r().Model)(d).attribute("weekId").attribute("homeTeamId").attribute("awayTeamId").attribute("matchDate",s().transformDate).attribute("cutoffDate",s().transformDate).attribute("allowDraw").attribute("status").attribute("homeScore").attribute("awayScore").attribute("result").attribute("canPick").hasOne("week").hasOne("homeTeam").hasOne("awayTeam"),(new(r().Store)).add("pickem-picks",h),new(r().Model)(h).attribute("userId").attribute("eventId").attribute("selectedOutcome").attribute("isCorrect").hasOne("event").hasOne("user"),(new(r().Store)).add("pickem-user-scores",f),new(r().Model)(f).attribute("userId").attribute("seasonId").attribute("totalPoints").attribute("totalPicks").attribute("correctPicks").attribute("accuracy").hasOne("user").hasOne("season")];function y(t,e,a,n,r,i,s){try{var o=t[i](s),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(n,r)}function b(t){return function(){var e=this,a=arguments;return new Promise(function(n,r){var i=t.apply(e,a);function s(t){y(i,n,r,s,o,"next",t)}function o(t){y(i,n,r,s,o,"throw",t)}s(void 0)})}}var g=a(183),k=a.n(g);const w=flarum.core.compat["admin/components/ExtensionPage"];var N=a.n(w);const z=flarum.core.compat["common/components/LoadingIndicator"];var T=a.n(z);const x=flarum.core.compat["common/components/Alert"];var _=a.n(x);const S=flarum.core.compat["common/Component"];var D=a.n(S);const C=flarum.core.compat["common/components/Button"];var I=a.n(C);const F=flarum.core.compat["common/components/Modal"];var L=a.n(F);const P=flarum.core.compat["common/utils/string"];var O=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).team=void 0,e.name="",e.slug="",e.logoPath="",e.loading=!1,e.uploadLoading=!1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.team=this.attrs.team,this.team&&(this.name=this.team.name()||"",this.slug=this.team.slug()||"",this.logoPath=this.team.logoPath()||"")},a.className=function(){return"TeamModal Modal--small"},a.title=function(){return this.team?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var t=this,e="fof-upload"in app.data.extensions;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(e){t.name=e.target.value,t.team||(t.slug=(0,P.slug)(t.name))}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.slug")),m("input",{className:"FormControl",type:"text",value:this.slug,oninput:function(e){t.slug=e.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.logo_url")),m("div",{style:{display:"flex",gap:"8px"}},m("input",{className:"FormControl",type:"text",value:this.logoPath,oninput:function(e){t.logoPath=e.target.value},placeholder:"https://example.com/logo.png",style:{flex:1}}),e&&m("[",null,m("input",{id:"pickem-logo-upload",type:"file",accept:"image/*",style:{display:"none"},onchange:this.handleUpload.bind(this)}),m(I(),{className:"Button Button--icon",icon:"fas fa-cloud-upload-alt",loading:this.uploadLoading,onclick:function(){var t=document.getElementById("pickem-logo-upload");t&&t.click()},title:"Upload with FoF Upload",type:"button"}))),this.logoPath&&m("div",{style:{marginTop:"10px"}},m("img",{src:this.logoPath,alt:"Logo preview",style:{maxWidth:"100px",maxHeight:"100px",border:"1px solid #ddd",padding:"5px",borderRadius:"4px"},onerror:function(t){t.target.style.display="none"}}))),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.handleUpload=function(){var t=b(k().mark(function t(e){var a,n,r,i,s;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a=e.target).files&&0!==a.files.length){t.next=1;break}return t.abrupt("return");case 1:return n=a.files[0],(r=new FormData).append("files[]",n),this.uploadLoading=!0,m.redraw(),t.prev=2,t.next=3,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/fof/upload",body:r,serialize:function(t){return t}});case 3:(i=t.sent)&&i.data&&i.data[0]&&i.data[0].attributes&&(this.logoPath=i.data[0].attributes.url,app.alerts.show({type:"success"},app.translator.trans("huseyinfiliz-pickem.lib.messages.saved"))),t.next=5;break;case 4:t.prev=4,s=t.catch(2),console.error("Logo upload failed:",s),app.alerts.show({type:"error"},"Upload failed. Check console for details.");case 5:return t.prev=5,this.uploadLoading=!1,a.value="",m.redraw(),t.finish(5);case 6:case"end":return t.stop()}},t,this,[[2,4,5,6]])}));return function(e){return t.apply(this,arguments)}}(),a.onsubmit=function(){var t=b(k().mark(function t(e){var a,n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,slug:this.slug,logoPath:this.logoPath},t.prev=1,n=this.team?this.team.save(a):app.store.createRecord("pickem-teams").save(a),t.next=2,n;case 2:this.attrs.onsave(),this.hide(),t.next=4;break;case 3:t.prev=3,r=t.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return t.stop()}},t,this,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),e}(L());const B=flarum.core.compat["common/utils/extractText"];var M=a.n(B),A=function(t){function e(){return t.apply(this,arguments)||this}l(e,t);var a=e.prototype;return a.view=function(){var t=this,e=app.store.all("pickem-teams");return m("div",{className:"TeamsTab"},m("div",{className:"TeamsTab-header"},m("h3",null,m("i",{className:"fas fa-users"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.teams")),m(I(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(O,{team:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.logo")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")),m("div",null)),e.map(function(e){return m("div",{key:e.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.logo")},t.renderTeamLogo(e)),m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},e.name()),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")},e.slug()),m("div",{className:"CardList-item-actions"},m(I(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(O,{team:e,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(I(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return t.deleteTeam(e)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.renderTeamLogo=function(t){var e=t.logoUrl(),a=t.name(),n=a?a.charAt(0).toUpperCase():"T",r=function(t){for(var e=0,a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return"hsl("+e%360+", 65%, 50%)"}(a||"Team");return e?m("img",{src:e,alt:a||"Team",className:"TeamLogo TeamLogo--image"}):m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.deleteTeam=function(t){var e=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(e)&&t.delete().then(function(){m.redraw()})},e}(D()),E=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).season=void 0,e.name="",e.slug="",e.startDate="",e.endDate="",e.loading=!1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.season=this.attrs.season,this.season&&(this.name=this.season.name()||"",this.slug=this.season.slug()||"",this.startDate=this.formatDateForInput(this.season.startDate()),this.endDate=this.formatDateForInput(this.season.endDate()))},a.formatDateForInput=function(t){return t?new Date(t).toISOString().slice(0,10):""},a.className=function(){return"SeasonModal Modal--small"},a.title=function(){return this.season?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var t=this;return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(e){t.name=e.target.value,t.season||(t.slug=(0,P.slug)(t.name))}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.slug")),m("input",{className:"FormControl",type:"text",value:this.slug,oninput:function(e){t.slug=e.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.start_date")),m("input",{className:"FormControl",type:"date",value:this.startDate,oninput:function(e){t.startDate=e.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.end_date")),m("input",{className:"FormControl",type:"date",value:this.endDate,oninput:function(e){t.endDate=e.target.value}})),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var t=b(k().mark(function t(e){var a,n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,slug:this.slug,startDate:this.startDate||null,endDate:this.endDate||null},t.prev=1,n=this.season?this.season.save(a):app.store.createRecord("pickem-seasons").save(a),t.next=2,n;case 2:this.attrs.onsave(),this.hide(),t.next=4;break;case 3:t.prev=3,r=t.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return t.stop()}},t,this,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),e}(L()),j=function(t){function e(){return t.apply(this,arguments)||this}l(e,t);var a=e.prototype;return a.view=function(){var t=this,e=app.store.all("pickem-seasons");return m("div",{className:"SeasonsTab"},m("div",{className:"SeasonsTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-alt"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.seasons")),m(I(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(E,{season:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.date")),m("div",null)),0===e.length?m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_data"))):e.map(function(e){return m("div",{key:e.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},e.name()),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.slug")},e.slug()),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.date")},e.startDate()&&e.endDate()?m("span",null,new Date(e.startDate()).toLocaleDateString()," - ",new Date(e.endDate()).toLocaleDateString()):"-"),m("div",{className:"CardList-item-actions"},m(I(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(E,{season:e,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(I(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return t.deleteSeason(e)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.deleteSeason=function(t){var e=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(e)&&t.delete().then(function(){m.redraw()})},e}(D());const U=flarum.core.compat["common/components/Select"];var G=a.n(U),R=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).week=void 0,e.name="",e.weekNumber="",e.seasonId="0",e.loading=!1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.week=this.attrs.week,this.week&&(this.name=this.week.name()||"",this.weekNumber=this.week.weekNumber()||"",this.seasonId=this.week.seasonId()||"0")},a.className=function(){return"WeekModal Modal--small"},a.title=function(){return this.week?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var t=this,e=app.store.all("pickem-seasons").reduce(function(t,e){return t[e.id()]=e.name(),t},{});return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.name")),m("input",{className:"FormControl",type:"text",value:this.name,oninput:function(e){t.name=e.target.value}})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m(G(),{className:"FormControl",value:this.seasonId,onchange:function(e){t.seasonId=e},options:e,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_season")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.week_number")),m("input",{className:"FormControl",type:"number",value:this.weekNumber,oninput:function(e){t.weekNumber=e.target.value}})),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var t=b(k().mark(function t(e){var a,n,r;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.loading=!0,m.redraw(),a={name:this.name,weekNumber:this.weekNumber||null,seasonId:"0"===this.seasonId?null:this.seasonId},t.prev=1,n=this.week?this.week.save(a):app.store.createRecord("pickem-weeks").save(a),t.next=2,n;case 2:this.attrs.onsave(),this.hide(),t.next=4;break;case 3:t.prev=3,r=t.catch(1),this.loading=!1,this.alertAttrs=r.alert,m.redraw();case 4:case"end":return t.stop()}},t,this,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),e}(L()),W=function(t){function e(){return t.apply(this,arguments)||this}l(e,t);var a=e.prototype;return a.view=function(){var t=this,e=app.store.all("pickem-weeks");return m("div",{className:"WeeksTab"},m("div",{className:"WeeksTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-week"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.weeks")),m(I(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(R,{week:null,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.name")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.week_number")),m("div",null)),0===e.length?m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_data"))):e.map(function(e){var a=e.season();return m("div",{key:e.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.name")},e.name()),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.season")},a?a.name():"-"),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.week_number")},e.weekNumber()),m("div",{className:"CardList-item-actions"},m(I(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(R,{week:e,onsave:function(){return m.redraw()}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(I(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return t.deleteWeek(e)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})))},a.deleteWeek=function(t){var e=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(e)&&t.delete().then(function(){m.redraw()})},e}(D()),q=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).event=void 0,e.homeTeamId="0",e.awayTeamId="0",e.weekId="0",e.matchDate="",e.cutoffDate="",e.allowDraw=!1,e.status="scheduled",e.loading=!1,e.homeTeamFilter="",e.awayTeamFilter="",e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.event=this.attrs.event,this.event&&(this.homeTeamId=this.event.homeTeamId()||"0",this.awayTeamId=this.event.awayTeamId()||"0",this.weekId=this.event.weekId()||"0",this.matchDate=this.formatDateForInput(this.event.matchDate()),this.cutoffDate=this.formatDateForInput(this.event.cutoffDate()),this.allowDraw=this.event.allowDraw()||!1,this.status=this.event.status()||"scheduled")},a.formatDateForInput=function(t){return t?t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0")+"T"+t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0"):""},a.className=function(){return"EventModal Modal--medium"},a.title=function(){return this.event?app.translator.trans("huseyinfiliz-pickem.lib.actions.edit"):app.translator.trans("huseyinfiliz-pickem.lib.actions.create")},a.content=function(){var t=this,e=app.store.all("pickem-teams"),a=app.store.all("pickem-weeks"),n=e.filter(function(e){var a;return null==(a=e.name())?void 0:a.toLowerCase().includes(t.homeTeamFilter.toLowerCase())});if("0"!==this.homeTeamId&&!n.find(function(e){return e.id()===t.homeTeamId})){var r=e.find(function(e){return e.id()===t.homeTeamId});r&&n.unshift(r)}var i=n.reduce(function(t,e){return t[e.id()]=e.name(),t},{}),s=e.filter(function(e){var a;return null==(a=e.name())?void 0:a.toLowerCase().includes(t.awayTeamFilter.toLowerCase())});if("0"!==this.awayTeamId&&!s.find(function(e){return e.id()===t.awayTeamId})){var o=e.find(function(e){return e.id()===t.awayTeamId});o&&s.unshift(o)}var l=s.reduce(function(t,e){return t[e.id()]=e.name(),t},{}),u=a.reduce(function(t,e){return t[e.id()]=e.name(),t},{});return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.week")),m(G(),{className:"FormControl",value:this.weekId,onchange:function(e){t.weekId=e},options:u,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.no_week")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.home_team")),m("input",{className:"FormControl",type:"text",placeholder:app.translator.trans("huseyinfiliz-pickem.lib.form.search_team"),value:this.homeTeamFilter,oninput:function(e){t.homeTeamFilter=e.target.value},style:"margin-bottom: 5px; font-size: 12px;"}),m(G(),{className:"FormControl",value:this.homeTeamId,onchange:function(e){t.homeTeamId=e},options:i,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_team")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.form.away_team")),m("input",{className:"FormControl",type:"text",placeholder:app.translator.trans("huseyinfiliz-pickem.lib.form.search_team"),value:this.awayTeamFilter,oninput:function(e){t.awayTeamFilter=e.target.value},style:"margin-bottom: 5px; font-size: 12px;"}),m(G(),{className:"FormControl",value:this.awayTeamId,onchange:function(e){t.awayTeamId=e},options:l,default:"0"},m("option",{value:"0"},app.translator.trans("huseyinfiliz-pickem.lib.form.select_team")))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")),m("input",{className:"FormControl",type:"datetime-local",value:this.matchDate,oninput:function(e){t.matchDate=e.target.value},required:!0})),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.cutoff_date")),m("input",{className:"FormControl",type:"datetime-local",value:this.cutoffDate,oninput:function(e){t.cutoffDate=e.target.value},required:!0})),m("div",{className:"Form-group"},m("label",{className:"checkbox"},m("input",{type:"checkbox",checked:this.allowDraw,onchange:function(e){t.allowDraw=e.target.checked}}),app.translator.trans("huseyinfiliz-pickem.lib.form.allow_draw"))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m(G(),{className:"FormControl",value:this.status,onchange:function(e){t.status=e},options:{scheduled:app.translator.trans("huseyinfiliz-pickem.lib.status.scheduled"),closed:app.translator.trans("huseyinfiliz-pickem.lib.status.closed"),finished:app.translator.trans("huseyinfiliz-pickem.lib.status.finished")}})),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.onsubmit=function(){var t=b(k().mark(function t(e){var a,n,r,i,s;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this.matchDate&&""!==this.matchDate.trim()){t.next=1;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),t.abrupt("return");case 1:if(this.cutoffDate&&""!==this.cutoffDate.trim()){t.next=2;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),t.abrupt("return");case 2:if("0"!==this.homeTeamId&&this.homeTeamId){t.next=3;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),t.abrupt("return");case 3:if("0"!==this.awayTeamId&&this.awayTeamId){t.next=4;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.invalid_outcome")),t.abrupt("return");case 4:if(this.homeTeamId!==this.awayTeamId){t.next=5;break}return app.alerts.show({type:"error"},app.translator.trans("huseyinfiliz-pickem.lib.messages.same_team")),t.abrupt("return");case 5:return this.loading=!0,m.redraw(),a=new Date(this.matchDate).toISOString(),n=new Date(this.cutoffDate).toISOString(),r={weekId:"0"===this.weekId?null:parseInt(this.weekId),homeTeamId:parseInt(this.homeTeamId),awayTeamId:parseInt(this.awayTeamId),matchDate:a,cutoffDate:n,allowDraw:this.allowDraw,status:this.status},t.prev=6,i=this.event?this.event.save(r):app.store.createRecord("pickem-events").save(r),t.next=7,i;case 7:this.attrs.onsave(),this.hide(),t.next=9;break;case 8:t.prev=8,s=t.catch(6),this.loading=!1,this.alertAttrs=s.alert,m.redraw();case 9:case"end":return t.stop()}},t,this,[[6,8]])}));return function(e){return t.apply(this,arguments)}}(),e}(L()),H=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).event=void 0,e.homeScore="",e.awayScore="",e.loading=!1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.event=this.attrs.event,this.homeScore=null!==this.event.homeScore()?this.event.homeScore():"",this.awayScore=null!==this.event.awayScore()?this.event.awayScore():""},a.className=function(){return"ResultModal Modal--small"},a.title=function(){return app.translator.trans("huseyinfiliz-pickem.lib.actions.enter_result")},a.content=function(){var t=this,e=this.event.homeTeam(),a=this.event.awayTeam(),n="",r=Number(this.homeScore),i=Number(this.awayScore);return""!==this.homeScore&&""!==this.awayScore&&(n=r>i?e?e.name():app.translator.trans("huseyinfiliz-pickem.lib.common.home"):i>r?a?a.name():app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.draw")),m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("div",{className:"TeamCell",style:{marginBottom:"8px"}},this.renderTeamLogo(e),m("label",{style:{margin:0}},e?e.name():app.translator.trans("huseyinfiliz-pickem.lib.form.home_team"))),m("input",{className:"FormControl",type:"number",min:"0",value:this.homeScore,oninput:function(e){t.homeScore=e.target.value}})),m("div",{className:"Form-group"},m("div",{className:"TeamCell",style:{marginBottom:"8px"}},this.renderTeamLogo(a),m("label",{style:{margin:0}},a?a.name():app.translator.trans("huseyinfiliz-pickem.lib.form.away_team"))),m("input",{className:"FormControl",type:"number",min:"0",value:this.awayScore,oninput:function(e){t.awayScore=e.target.value}})),n&&m("div",{className:"Form-group"},m("p",null,m("strong",null,app.translator.trans("huseyinfiliz-pickem.lib.common.result"),": "),n)),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",type:"submit",loading:this.loading},app.translator.trans("huseyinfiliz-pickem.lib.buttons.save")))))},a.renderTeamLogo=function(t){if(!t)return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:"#999"}},"?");var e=t.logoUrl(),a=t.name(),n=a?a.charAt(0).toUpperCase():"T";if(e)return m("img",{src:e,alt:a||"Team",className:"TeamLogo TeamLogo--image"});var r=function(t){for(var e=0,a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return"hsl("+e%360+", 65%, 50%)"}(a||"Team");return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.onsubmit=function(){var t=b(k().mark(function t(e){var a,n;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.loading=!0,m.redraw(),t.prev=1,t.next=2,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/pickem-events/"+this.event.id()+"/result",body:{data:{type:"pickem-events",attributes:{homeScore:parseInt(this.homeScore)||0,awayScore:parseInt(this.awayScore)||0}}}});case 2:a=t.sent,app.store.pushPayload(a),app.alerts.show({type:"success"},app.translator.trans("huseyinfiliz-pickem.lib.messages.result_saved")),this.attrs.onsave(),this.hide(),t.next=4;break;case 3:t.prev=3,n=t.catch(1),this.loading=!1,this.alertAttrs=n.alert,m.redraw();case 4:case"end":return t.stop()}},t,this,[[1,3]])}));return function(e){return t.apply(this,arguments)}}(),e}(L()),Y=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).selectedSeason="all",e.selectedTeam="all",e.selectedStatus="all",e.sortOrder="desc",e.loading=!1,e.events=[],e.hasMore=!1,e.limit=20,e.page=1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.loadEvents(!0)},a.buildFilters=function(){var t=this,e={},a=[];if("all"!==this.selectedSeason){var n=app.store.all("pickem-weeks").filter(function(e){return e.seasonId()==t.selectedSeason});a.push.apply(a,n.map(function(t){return String(t.id())})),0===a.length&&a.push("0"),a.push("null"),e.week=a.join(",")}return"all"!==this.selectedTeam&&(e.team=this.selectedTeam),"all"!==this.selectedStatus&&(e.status=this.selectedStatus),e},a.loadEvents=function(t){var e=this;void 0===t&&(t=!1),this.loading=!0,m.redraw();var a=t?0:this.events.length,n=this.buildFilters(),r="desc"===this.sortOrder?"-matchDate":"matchDate";app.store.find("pickem-events",{include:"homeTeam,awayTeam,week",filter:n,sort:r,page:{limit:this.limit,offset:a}}).then(function(a){e.events=t?a:[].concat(e.events,a),e.hasMore=a.length>=e.limit,e.loading=!1,m.redraw()}).catch(function(t){e.loading=!1,console.error(t),m.redraw()})},a.view=function(){var t=this,e=app.store.all("pickem-seasons"),a=app.store.all("pickem-teams"),n=this.events.length>0,r="1"===app.data.settings["huseyinfiliz-pickem.reverse_display"];return m("div",{className:"EventsTab"},m("div",{className:"EventsTab-header"},m("h3",null,m("i",{className:"fas fa-calendar-alt"}),app.translator.trans("huseyinfiliz-pickem.lib.nav.matches")),m(I(),{className:"Button Button--primary",icon:"fas fa-plus",onclick:function(){return app.modal.show(q,{event:null,onsave:function(){return t.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.create"))),m("div",{className:"EventsTab-filters"},m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.season")),m("select",{value:this.selectedSeason,onchange:function(e){t.selectedSeason=e.target.value,t.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),e.map(function(t){return m("option",{key:t.id(),value:t.id()},t.name())}))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.team")),m("select",{value:this.selectedTeam,onchange:function(e){t.selectedTeam=e.target.value,t.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),a.map(function(t){return m("option",{key:t.id(),value:t.id()},t.name())}))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m("select",{value:this.selectedStatus,onchange:function(e){t.selectedStatus=e.target.value,t.loadEvents(!0)}},m("option",{value:"all"},app.translator.trans("huseyinfiliz-pickem.lib.filters.all")),m("option",{value:"scheduled"},app.translator.trans("huseyinfiliz-pickem.lib.status.scheduled")),m("option",{value:"closed"},app.translator.trans("huseyinfiliz-pickem.lib.status.closed")),m("option",{value:"finished"},app.translator.trans("huseyinfiliz-pickem.lib.status.finished")))),m("div",{className:"FormGroup"},m("label",null,app.translator.trans("huseyinfiliz-pickem.lib.filters.sort")),m("select",{value:this.sortOrder,onchange:function(e){t.sortOrder=e.target.value,t.loadEvents(!0)}},m("option",{value:"desc"},app.translator.trans("huseyinfiliz-pickem.lib.filters.newest")),m("option",{value:"asc"},app.translator.trans("huseyinfiliz-pickem.lib.filters.oldest"))))),n||this.loading?m("div",{className:"CardList"},m("div",{className:"CardList-header"},m("div",null,r?app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.home")),m("div",null,r?app.translator.trans("huseyinfiliz-pickem.lib.common.home"):app.translator.trans("huseyinfiliz-pickem.lib.common.away")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.status")),m("div",null,app.translator.trans("huseyinfiliz-pickem.lib.common.score")),m("div",null)),this.events.map(function(e){var a=e.homeTeam(),n=e.awayTeam();return m("div",{key:e.id(),className:"CardList-item"},m("div",{className:"CardList-item-cell CardList-item-cell--primary","data-label":r?app.translator.trans("huseyinfiliz-pickem.lib.common.away"):app.translator.trans("huseyinfiliz-pickem.lib.common.home")},m("div",{className:"TeamCell"},t.renderTeamLogo(r?n:a),m("span",null,r?n?n.name():"N/A":a?a.name():"N/A"))),m("div",{className:"CardList-item-cell","data-label":r?app.translator.trans("huseyinfiliz-pickem.lib.common.home"):app.translator.trans("huseyinfiliz-pickem.lib.common.away")},m("div",{className:"TeamCell"},t.renderTeamLogo(r?a:n),m("span",null,r?a?a.name():"N/A":n?n.name():"N/A"))),m("div",{className:"CardList-item-cell CardList-item-cell--muted","data-label":app.translator.trans("huseyinfiliz-pickem.lib.headers.match_date")},e.matchDate()?new Date(e.matchDate()).toLocaleString():"-"),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.status")},m("span",{className:"StatusBadge StatusBadge--"+e.status()},app.translator.trans("huseyinfiliz-pickem.lib.status."+e.status()))),m("div",{className:"CardList-item-cell","data-label":app.translator.trans("huseyinfiliz-pickem.lib.common.score")},null!==e.homeScore()&&null!==e.awayScore()?r?e.awayScore()+" - "+e.homeScore():e.homeScore()+" - "+e.awayScore():"-"),m("div",{className:"CardList-item-actions"},m(I(),{className:"Button Button--primary",icon:"fas fa-edit",onclick:function(){return app.modal.show(q,{event:e,onsave:function(){return t.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.edit")),m(I(),{className:"Button Button--success",icon:"fas fa-check",onclick:function(){return app.modal.show(H,{event:e,onsave:function(){return t.loadEvents(!0)}})}},app.translator.trans("huseyinfiliz-pickem.lib.actions.enter_result")),m(I(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return t.deleteEvent(e)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.delete"))))})):m("div",{className:"EmptyState"},m("i",{className:"fas fa-calendar-times"}),m("p",null,app.translator.trans("huseyinfiliz-pickem.lib.messages.no_matches"))),this.loading&&m(T(),null),this.hasMore&&!this.loading&&m("div",{className:"LoadMore"},m(I(),{className:"Button Button--primary",onclick:function(){return t.loadEvents(!1)}},app.translator.trans("huseyinfiliz-pickem.lib.buttons.load_more"))))},a.renderTeamLogo=function(t){if(!t)return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:"#999"}},"?");var e=t.logoUrl(),a=t.name(),n=a?a.charAt(0).toUpperCase():"?";if(e)return m("img",{src:e,alt:a||"Team",className:"TeamLogo TeamLogo--image"});var r=function(t){for(var e=0,a=0;a<t.length;a++)e=t.charCodeAt(a)+((e<<5)-e);return"hsl("+e%360+", 65%, 50%)"}(a||"Team");return m("div",{className:"TeamLogo TeamLogo--letter",style:{backgroundColor:r}},n)},a.deleteEvent=function(t){var e=this,a=M()(app.translator.trans("huseyinfiliz-pickem.lib.messages.delete_confirm"));confirm(a)&&t.delete().then(function(){e.loadEvents(!0)})},e}(D());const J=flarum.core.compat["common/utils/Stream"];var K=a.n(J),Q=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).navTitle=void 0,e.votesPerCategory=void 0,e.loading=!1,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.navTitle=K()(app.data.settings["huseyinfiliz-awards.nav_title"]||"Awards"),this.votesPerCategory=K()(parseInt(app.data.settings["huseyinfiliz-awards.votes_per_category"]||"1"))},a.view=function(){return m("div",{className:"SettingsTab"},m("div",{className:"Form-group"},m("h3",null,m("i",{className:"fas fa-cogs"}),app.translator.trans("huseyinfiliz-awards.admin.tabs.settings")),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-awards.admin.settings.nav_title")),m("input",{className:"FormControl",bidi:this.navTitle}),m("div",{className:"helpText"},app.translator.trans("huseyinfiliz-awards.admin.settings.nav_title_help"))),m("div",{className:"Form-group"},m("label",null,app.translator.trans("huseyinfiliz-awards.admin.settings.votes_per_category")),m("input",{className:"FormControl",type:"number",min:"0",bidi:this.votesPerCategory}),m("div",{className:"helpText"},app.translator.trans("huseyinfiliz-awards.admin.settings.votes_per_category_help"))),m("div",{className:"Form-group"},m(I(),{className:"Button Button--primary",loading:this.loading,onclick:this.saveSettings.bind(this)},app.translator.trans("huseyinfiliz-awards.lib.buttons.save")))))},a.saveSettings=function(){var t=this;this.loading=!0,app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/settings",body:{"huseyinfiliz-awards.nav_title":this.navTitle(),"huseyinfiliz-awards.votes_per_category":this.votesPerCategory()}}).then(function(){t.loading=!1,m.redraw(),app.alerts.show({type:"success"},app.translator.trans("core.lib.success_message"))})},e}(D()),V=function(t){function e(){for(var e,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).activeTab="events",e.loading=!0,e.error=null,e}l(e,t);var a=e.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e);var a=m.route.param("tab");a&&["events","teams","seasons","weeks","settings"].includes(a)&&(this.activeTab=a),this.loadData()},a.loadData=function(){var t=b(k().mark(function t(){var e;return k().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,Promise.all([app.store.find("pickem-teams"),app.store.find("pickem-seasons"),app.store.find("pickem-weeks",{include:"season"})]);case 1:this.error=null,t.next=3;break;case 2:t.prev=2,e=t.catch(0),console.error("Pickem admin data load error:",e),this.error=e.message||"An unknown error occurred while loading data.";case 3:return t.prev=3,this.loading=!1,m.redraw(),t.finish(3);case 4:case"end":return t.stop()}},t,this,[[0,2,3,4]])}));return function(){return t.apply(this,arguments)}}(),a.content=function(){var t;return t=this.loading?m("div",{className:"LoadingState"},m(T(),null)):this.error?m(_(),{type:"error"},this.error):this.renderTabContent(),m("div",{className:"PickemPage"},m("div",{className:"container"},m("div",{className:"PickemPage-tabs"},this.renderTab("events","fas fa-futbol",app.translator.trans("huseyinfiliz-pickem.lib.nav.matches")),this.renderTab("teams","fas fa-users",app.translator.trans("huseyinfiliz-pickem.lib.nav.teams")),this.renderTab("seasons","fas fa-calendar-alt",app.translator.trans("huseyinfiliz-pickem.lib.nav.seasons")),this.renderTab("weeks","fas fa-calendar-week",app.translator.trans("huseyinfiliz-pickem.lib.nav.weeks")),this.renderTab("settings","fas fa-cogs",app.translator.trans("huseyinfiliz-pickem.lib.nav.settings"))),m("div",{className:"PickemPage-content"},t)))},a.renderTab=function(t,e,a){var n=this,r=this.activeTab===t;return m("button",{className:"Button "+(r?"Button--primary":""),onclick:function(){n.activeTab=t;var e=m.route.get().split("?")[0];m.route.set(e,{tab:t},{replace:!0})}},m("i",{className:e})," ",m("span",null,a))},a.renderTabContent=function(){switch(this.activeTab){case"events":default:return m(Y,null);case"teams":return m(A,null);case"seasons":return m(j,null);case"weeks":return m(W,null);case"settings":return m(Q,null)}},e}(N());e().initializers.add("huseyinfiliz/pickem",function(){v.forEach(function(t){return t.extend(e())}),e().extensionData.for("huseyinfiliz-pickem").registerPage(V).registerPermission({icon:"fas fa-trophy",label:e().translator.trans("huseyinfiliz-pickem.admin.permissions.manage"),permission:"pickem.manage"},"moderate").registerPermission({icon:"fas fa-check-circle",label:e().translator.trans("huseyinfiliz-pickem.admin.permissions.make_picks"),permission:"pickem.makePicks"},"start").registerPermission({icon:"fas fa-eye",label:e().translator.trans("huseyinfiliz-pickem.admin.permissions.view_page"),permission:"pickem.view",allowGuest:!0},"view")})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map