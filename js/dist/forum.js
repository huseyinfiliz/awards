/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={24(t,e,r){var a=r(163),n=r(110),o=r(996),s=r(312),i=r(166),l=r(766),u=r(760);function c(){"use strict";var e=n(),r=e.m(c),d=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function m(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))}var f={throw:1,return:2,break:3,continue:3};function h(t){var e,r;return function(a){e||(e={stop:function(){return r(a.a,2)},catch:function(){return a.v},abrupt:function(t,e){return r(a.a,f[t],e)},delegateYield:function(t,n,o){return e.resultName=n,r(a.d,u(t),o)},finish:function(t){return r(a.f,t)}},r=function(t,r,n){a.p=e.prev,a.n=e.next;try{return t(r,n)}finally{e.next=a.n}}),e.resultName&&(e[e.resultName]=a.v,e.resultName=void 0),e.sent=a.v,e.next=a.n;try{return t.call(this,e)}finally{a.p=e.prev,a.n=e.next}}}return(t.exports=c=function(){return{wrap:function(t,r,a,n){return e.w(h(t),r,a,n&&n.reverse())},isGeneratorFunction:m,mark:e.m,awrap:function(t,e){return new a(t,e)},AsyncIterator:i,async:function(t,e,r,a,n){return(m(e)?s:o)(h(t),e,r,a,n)},keys:l,values:u}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports},110(t,e,r){var a=r(397);function n(){var e,r,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function l(t,n,o,s){var i=n&&n.prototype instanceof c?n:c,l=Object.create(i.prototype);return a(l,"_invoke",function(t,a,n){var o,s,i,l=0,c=n||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return o=t,s=0,i=e,m.n=r,u}};function f(t,a){for(s=t,i=a,r=0;!d&&l&&!n&&r<c.length;r++){var n,o=c[r],f=m.p,h=o[2];t>3?(n=h===a)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((n=t<2&&f<o[1])?(s=0,m.v=a,m.n=o[1]):f<h&&(n=t<3||o[0]>a||a>h)&&(o[4]=t,o[5]=a,m.n=h,s=0))}if(n||t>1)return u;throw d=!0,a}return function(n,c,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,h),s=c,i=h;(r=s<2?e:i)||!d;){o||(s?s<3?(s>1&&(m.n=-1),f(s,i)):m.n=i:m.v=i);try{if(l=2,o){if(s||(n="next"),r=o[n]){if(!(r=r.call(o,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,s<2&&(s=0)}else 1===s&&(r=o.return)&&r.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),s=1);o=e}else if((r=(d=m.n<0)?i:t.call(a,m))!==u)break}catch(t){o=e,s=1,i=t}finally{l=1}}return{value:r,done:d}}}(t,o,s),!0),l}var u={};function c(){}function d(){}function m(){}r=Object.getPrototypeOf;var f=[][s]?r(r([][s]())):(a(r={},s,function(){return this}),r),h=m.prototype=c.prototype=Object.create(f);function g(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,a(t,i,"GeneratorFunction")),t.prototype=Object.create(h),t}return d.prototype=m,a(h,"constructor",m),a(m,"constructor",d),d.displayName="GeneratorFunction",a(m,i,"GeneratorFunction"),a(h),a(h,i,"Generator"),a(h,s,function(){return this}),a(h,"toString",function(){return"[object Generator]"}),(t.exports=n=function(){return{w:l,m:g}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},163(t){t.exports=function(t,e){this.v=t,this.k=e},t.exports.__esModule=!0,t.exports.default=t.exports},166(t,e,r){var a=r(163),n=r(397);t.exports=function t(e,r){function o(t,n,s,i){try{var l=e[t](n),u=l.value;return u instanceof a?r.resolve(u.v).then(function(t){o("next",t,s,i)},function(t){o("throw",t,s,i)}):r.resolve(u).then(function(t){l.value=t,s(l)},function(t){return o("throw",t,s,i)})}catch(t){i(t)}}var s;this.next||(n(t.prototype),n(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),n(this,"_invoke",function(t,e,a){function n(){return new r(function(e,r){o(t,a,e,r)})}return s=s?s.then(n,n):n()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports},183(t,e,r){var a=r(24)();t.exports=a;try{regeneratorRuntime=a}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}},312(t,e,r){var a=r(110),n=r(166);t.exports=function(t,e,r,o,s){return new n(a().w(t,e,r,o),s||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports},397(t){function e(r,a,n,o){var s=Object.defineProperty;try{s({},"",{})}catch(r){s=0}t.exports=e=function(t,r,a,n){function o(r,a){e(t,r,function(t){return this._invoke(r,a,t)})}r?s?s(t,r,{value:a,enumerable:!n,configurable:!n,writable:!n}):t[r]=a:(o("next",0),o("throw",1),o("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,a,n,o)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},735(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},760(t,e,r){var a=r(735).default;t.exports=function(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(a(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports},766(t){t.exports=function(t){var e=Object(t),r=[];for(var a in e)r.unshift(a);return function t(){for(;r.length;)if((a=r.pop())in e)return t.value=a,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports},996(t,e,r){var a=r(312);t.exports=function(t,e,r,n,o){var s=a(t,e,r,n,o);return s.next().then(function(t){return t.done?t.value:s.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function r(a){var n=e[a];if(void 0!==n)return n.exports;var o=e[a]={exports:{}};return t[a](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=flarum.core.compat["forum/app"];var e=r.n(t);const a=flarum.core.compat["common/extend"],n=flarum.core.compat["forum/components/IndexPage"];var o=r.n(n);const s=flarum.core.compat["common/components/LinkButton"];var i=r.n(s);const l=flarum.core.compat["common/extenders"];var u=r.n(l);function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function d(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,c(t,e)}const f=flarum.core.compat["common/Model"];var h=r.n(f),g=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).name=h().attribute("name"),e.slug=h().attribute("slug"),e.year=h().attribute("year"),e.description=h().attribute("description"),e.startsAt=h().attribute("startsAt",h().transformDate),e.endsAt=h().attribute("endsAt",h().transformDate),e.status=h().attribute("status"),e.effectiveStatus=h().attribute("effectiveStatus"),e.showLiveVotes=h().attribute("showLiveVotes"),e.imageUrl=h().attribute("imageUrl"),e.createdAt=h().attribute("createdAt",h().transformDate),e.updatedAt=h().attribute("updatedAt",h().transformDate),e.categories=h().hasMany("categories"),e.categoryCount=h().attribute("categoryCount"),e.nomineeCount=h().attribute("nomineeCount"),e.voteCount=h().attribute("voteCount"),e.canViewResults=h().attribute("canViewResults"),e}d(e,t);var r=e.prototype;return r.isDraft=function(){return"draft"===this.status()},r.isActive=function(){return"active"===this.status()},r.hasEnded=function(){return"ended"===this.status()},r.isPublished=function(){return"published"===this.status()},r.isVotingOpen=function(){var t=new Date,e=this.startsAt(),r=this.endsAt();return this.isActive()&&e&&r&&t>=e&&t<=r},r.canShowVotes=function(){return this.isPublished()||this.isActive()&&this.showLiveVotes()},r.hasEffectivelyEnded=function(){var t=this.effectiveStatus()||this.status();return"ended"===t||"published"===t},e}(h()),v=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).name=h().attribute("name"),e.slug=h().attribute("slug"),e.description=h().attribute("description"),e.sortOrder=h().attribute("sortOrder"),e.allowOther=h().attribute("allowOther"),e.createdAt=h().attribute("createdAt",h().transformDate),e.updatedAt=h().attribute("updatedAt",h().transformDate),e.award=h().hasOne("award"),e.nominees=h().hasMany("nominees"),e.votes=h().hasMany("votes"),e.otherSuggestions=h().hasMany("otherSuggestions"),e.nomineeCount=h().attribute("nomineeCount"),e.voteCount=h().attribute("voteCount"),e.userVoteIds=h().attribute("userVoteIds"),e.userPendingSuggestionsCount=h().attribute("userPendingSuggestionsCount"),e}d(e,t);var r=e.prototype;return r.hasUserVoted=function(){var t=this.userVoteIds();return t&&t.length>0},r.getUserVotedNomineeIds=function(){return this.userVoteIds()||[]},e}(h()),p=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).name=h().attribute("name"),e.description=h().attribute("description"),e.slug=h().attribute("slug"),e.imageUrl=h().attribute("imageUrl"),e.metadata=h().attribute("metadata"),e.sortOrder=h().attribute("sortOrder"),e.createdAt=h().attribute("createdAt",h().transformDate),e.updatedAt=h().attribute("updatedAt",h().transformDate),e.category=h().hasOne("category"),e.voteCount=h().attribute("voteCount"),e.votePercentage=h().attribute("votePercentage"),e.realVoteCount=h().attribute("realVoteCount"),e.voteAdjustment=h().attribute("voteAdjustment"),e.rank=h().attribute("rank"),e.isWinner=h().attribute("isWinner"),e.isRunnerUp=h().attribute("isRunnerUp"),e.isThirdPlace=h().attribute("isThirdPlace"),e}return d(e,t),e}(h()),y=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).createdAt=h().attribute("createdAt",h().transformDate),e.nomineeId=h().attribute("nomineeId"),e.categoryId=h().attribute("categoryId"),e.nominee=h().hasOne("nominee"),e.category=h().hasOne("category"),e.user=h().hasOne("user"),e}return d(e,t),e}(h()),w=function(t){function e(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).name=h().attribute("name"),e.status=h().attribute("status"),e.createdAt=h().attribute("createdAt",h().transformDate),e.updatedAt=h().attribute("updatedAt",h().transformDate),e.category=h().hasOne("category"),e.user=h().hasOne("user"),e.mergedToNominee=h().hasOne("mergedToNominee"),e}d(e,t);var r=e.prototype;return r.isPending=function(){return"pending"===this.status()},r.isApproved=function(){return"approved"===this.status()},r.isRejected=function(){return"rejected"===this.status()},r.isMerged=function(){return"merged"===this.status()},e}(h());const N=[(new(u().Store)).add("awards",g).add("award-categories",v).add("award-nominees",p).add("award-votes",y).add("award-other-suggestions",w)];function C(t,e,r,a,n,o,s){try{var i=t[o](s),l=i.value}catch(t){return void r(t)}i.done?e(l):Promise.resolve(l).then(a,n)}function b(t){return function(){var e=this,r=arguments;return new Promise(function(a,n){var o=t.apply(e,r);function s(t){C(o,a,n,s,i,"next",t)}function i(t){C(o,a,n,s,i,"throw",t)}s(void 0)})}}var V=r(183),A=r.n(V);const S=flarum.core.compat["common/components/Page"];var x=r.n(S);const I=flarum.core.compat["common/components/LoadingIndicator"];var M=r.n(I);const _=flarum.core.compat["common/components/Select"];var P=r.n(_);const z=flarum.core.compat["common/components/Button"];var k=r.n(z);const O=flarum.core.compat["common/helpers/listItems"];var B=r.n(O);const T=flarum.core.compat["common/utils/extractText"];var R=r.n(T);const U=flarum.core.compat["common/Component"];var E=r.n(U),D=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).loading=!1,e}d(r,t);var a=r.prototype;return a.view=function(){var t=this,r=this.attrs.nominee,a=this.attrs.category,n=this.attrs.award,o=e().store.all("award-votes"),s=r.id(),i=a.id(),l=o.find(function(t){var e,r,a=(null==t.nomineeId?void 0:t.nomineeId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.nominee)||null==(e=e.data)?void 0:e.id),n=(null==t.categoryId?void 0:t.categoryId())||(null==(r=t.data)||null==(r=r.relationships)||null==(r=r.category)||null==(r=r.data)?void 0:r.id);return String(a)===String(s)&&String(n)===String(i)}),u=!!l,c=n.isVotingOpen()&&e().session.user,d=n.canShowVotes(),f=c&&!this.loading;return m("div",{className:"NomineeCard "+(u?"NomineeCard--voted":"")+" "+(f?"NomineeCard--clickable":"")+" "+(this.loading?"NomineeCard--loading":""),onclick:f?function(){return t.toggleVote(r,a,l)}:void 0,role:f?"button":void 0,tabindex:f?0:void 0,onkeydown:f?function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.toggleVote(r,a,l))}:void 0},m("div",{className:"NomineeCard-image"},r.imageUrl()?m("img",{src:r.imageUrl(),alt:r.name(),loading:"lazy"}):m("div",{className:"NomineeCard-placeholder"},m("i",{className:"fas fa-user"})),u?m("div",{className:"NomineeCard-check"},m("i",{className:"fas fa-check"})):null),m("div",{className:"NomineeCard-content"},m("h3",{className:"NomineeCard-title"},r.name()),r.description()?m("p",{className:"NomineeCard-description"},r.description()):null,d?m("div",{className:"NomineeCard-stats"},m("span",{className:"NomineeCard-votes"},e().translator.trans("huseyinfiliz-awards.forum.results.votes",{count:r.voteCount()||0}))):null,this.loading?m("div",{className:"NomineeCard-loading"},m("i",{className:"fas fa-spinner fa-spin"})):null))},a.updateCategoryUserVoteIds=function(t){var r=t.id(),a=e().store.all("award-votes").filter(function(t){var e,a=(null==t.categoryId?void 0:t.categoryId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.category)||null==(e=e.data)?void 0:e.id);return String(a)===String(r)}).map(function(t){var e;return(null==t.nomineeId?void 0:t.nomineeId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.nominee)||null==(e=e.data)?void 0:e.id)}).filter(Boolean);t.pushData({attributes:{userVoteIds:a}})},a.toggleVote=function(t,r,a){var n=this;if(e().session.user){var o=r.id(),s=parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10);if(a)return this.loading=!0,m.redraw(),void a.delete().then(function(){var a=(null==t.voteCount?void 0:t.voteCount())||0;a>0&&t.pushData({attributes:{voteCount:a-1}}),n.updateCategoryUserVoteIds(r),e().alerts.show({type:"success"},e().translator.trans("huseyinfiliz-awards.forum.voting.vote_removed")),n.loading=!1,m.redraw()}).catch(function(t){throw n.loading=!1,m.redraw(),t});var i=e().store.all("award-votes").filter(function(t){var e,r=(null==t.categoryId?void 0:t.categoryId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.category)||null==(e=e.data)?void 0:e.id);return String(r)===String(o)});s>0&&i.length>=s&&1!==s?e().alerts.show({type:"error"},e().translator.trans("huseyinfiliz-awards.forum.error.vote_limit_reached",{limit:s})):(this.loading=!0,m.redraw(),e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/award-votes",body:{data:{attributes:{nomineeId:t.id()}}}}).then(function(a){1===s&&i.forEach(function(r){var a,n=(null==r.nomineeId?void 0:r.nomineeId())||(null==(a=r.data)||null==(a=a.relationships)||null==(a=a.nominee)||null==(a=a.data)?void 0:a.id);if(n&&String(n)!==String(t.id())){var o=e().store.getById("award-nominees",String(n));if(o){var s=(null==o.voteCount?void 0:o.voteCount())||0;s>0&&o.pushData({attributes:{voteCount:s-1}})}}e().store.remove(r)});var o=(null==t.voteCount?void 0:t.voteCount())||0;t.pushData({attributes:{voteCount:o+1}}),e().store.pushPayload(a),n.updateCategoryUserVoteIds(r),e().alerts.show({type:"success"},e().translator.trans("huseyinfiliz-awards.forum.voting.vote_saved")),n.loading=!1,m.redraw()}).catch(function(t){throw n.loading=!1,m.redraw(),t}))}},r}(E());const j=flarum.core.compat["common/components/Modal"];var F=r.n(j);const H=flarum.core.compat["common/utils/Stream"];var L=r.n(H);const G=flarum.core.compat["common/components/Alert"];var q=r.n(G),W=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).category=void 0,e.name=void 0,e.suggestions=[],e.loadingSuggestions=!0,e.cancellingId=null,e}d(r,t);var a=r.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.category=this.attrs.category,this.name=L()(""),this.loadSuggestions()},a.className=function(){return"HFAwardsModal HFAwardsSuggestionModal Modal--small"},a.title=function(){return e().translator.trans("huseyinfiliz-awards.forum.other.suggest")},a.loadSuggestions=function(){var t=b(A().mark(function t(){var r,a;return A().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingSuggestions=!0,m.redraw(),t.prev=1,t.next=2,e().request({method:"GET",url:e().forum.attribute("apiUrl")+"/award-other-suggestions/mine",params:{"filter[category]":this.category.id()}});case 2:r=t.sent,this.suggestions=(r.data||[]).map(function(t){return e().store.pushObject(t)}),t.next=4;break;case 3:t.prev=3,a=t.catch(1),console.error("Failed to load suggestions:",a),this.suggestions=[];case 4:this.loadingSuggestions=!1,m.redraw();case 5:case"end":return t.stop()}},t,this,[[1,3]])}));return function(){return t.apply(this,arguments)}}(),a.getRemainingSlots=function(){var t=(this.category.userVoteIds()||[]).length,r=parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10);if(0===r)return 1/0;var a=this.suggestions.filter(function(t){return t.isPending()}).length;return Math.max(0,r-t-a)},a.updateCategoryPendingCount=function(){var t=this.suggestions.filter(function(t){return t.isPending()}).length;this.category.pushData({attributes:{userPendingSuggestionsCount:t}})},a.content=function(){var t=this;if(this.loadingSuggestions)return m("div",{className:"Modal-body"},m(M(),null));var r=this.getRemainingSlots(),a=0===parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10);return m("div",{className:"Modal-body"},a||r>0?m("div",{className:"SuggestionModal-form"},m("div",{className:"Form-group"},m("label",null,e().translator.trans("huseyinfiliz-awards.forum.other.placeholder")),m("input",{className:"FormControl",bidi:this.name,required:!0})),m("div",{className:"Form-group"},m(k(),{className:"Button Button--primary",type:"submit",loading:this.loading,disabled:!this.name()},e().translator.trans("huseyinfiliz-awards.forum.other.submit")),!a&&m("span",{className:"SuggestionModal-remaining"},e().translator.trans("huseyinfiliz-awards.forum.other.remaining",{count:r})))):m("div",{className:"Form-group"},m(q(),{type:"warning",dismissible:!1},e().translator.trans("huseyinfiliz-awards.forum.other.no_remaining"))),m("div",{className:"SuggestionModal-list"},m("h4",{className:"SuggestionModal-listTitle"},e().translator.trans("huseyinfiliz-awards.forum.other.my_suggestions")),0===this.suggestions.length?m("p",{className:"SuggestionModal-empty"},e().translator.trans("huseyinfiliz-awards.forum.other.no_suggestions")):m("ul",{className:"SuggestionModal-suggestions"},this.suggestions.map(function(e){return t.renderSuggestionItem(e)}))))},a.renderSuggestionItem=function(t){var r=this,a=t.status(),n={pending:e().translator.trans("huseyinfiliz-awards.forum.other.status_pending"),approved:e().translator.trans("huseyinfiliz-awards.forum.other.status_approved"),rejected:e().translator.trans("huseyinfiliz-awards.forum.other.status_rejected"),merged:e().translator.trans("huseyinfiliz-awards.forum.other.status_merged")};return m("li",{className:"SuggestionModal-item",key:t.id()},m("span",{className:"SuggestionModal-itemName"},t.name()),m("span",{className:"SuggestionModal-itemStatus SuggestionModal-itemStatus--"+a},n[a]||a),t.isPending()&&m(k(),{className:"Button Button--icon Button--link SuggestionModal-itemCancel",icon:"fas fa-times",onclick:function(){return r.cancelSuggestion(t)},loading:this.cancellingId===t.id(),title:e().translator.trans("huseyinfiliz-awards.forum.other.cancel")}))},a.cancelSuggestion=function(){var t=b(A().mark(function t(r){var a;return A().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm(e().translator.trans("huseyinfiliz-awards.forum.other.cancel_confirm"))){t.next=1;break}return t.abrupt("return");case 1:return this.cancellingId=r.id(),m.redraw(),t.prev=2,t.next=3,e().request({method:"DELETE",url:e().forum.attribute("apiUrl")+"/award-other-suggestions/"+r.id()});case 3:this.suggestions=this.suggestions.filter(function(t){return t.id()!==r.id()}),this.updateCategoryPendingCount(),t.next=5;break;case 4:t.prev=4,a=t.catch(2),console.error("Failed to cancel suggestion:",a);case 5:this.cancellingId=null,m.redraw();case 6:case"end":return t.stop()}},t,this,[[2,4]])}));return function(e){return t.apply(this,arguments)}}(),a.onsubmit=function(t){var r=this;t.preventDefault(),this.loading=!0,e().request({method:"POST",url:e().forum.attribute("apiUrl")+"/award-other-suggestions",body:{data:{attributes:{categoryId:this.category.id(),name:this.name()}}},errorHandler:this.onerror.bind(this)}).then(function(t){var a=e().store.pushObject(t.data);r.suggestions.unshift(a),r.name(""),r.loading=!1,r.updateCategoryPendingCount(),m.redraw()}).catch(function(){r.loading=!1,m.redraw()})},r}(F()),Y=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var a=r.prototype;return a.openModal=function(t){e().modal.show(W,{category:t})},a.view=function(){var t=this,r=this.attrs.category,a=r.userPendingSuggestionsCount()||0,n=(r.userVoteIds()||[]).length,o=parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10),s=0===o,i=s?1/0:o-n-a,l=!s&&i<=0;return m("div",{className:"NomineeCard NomineeCard--other NomineeCard--clickable "+(l?"NomineeCard--exhausted":""),onclick:function(){return t.openModal(r)},role:"button",tabindex:0,onkeydown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.openModal(r))}},m("div",{className:"NomineeCard-image"},m("div",{className:"NomineeCard-placeholder"},m("i",{className:l?"fas fa-list":"fas fa-plus"}))),m("div",{className:"NomineeCard-content"},m("h3",{className:"NomineeCard-title"},e().translator.trans("huseyinfiliz-awards.forum.other.suggest")),m("p",{className:"NomineeCard-description"},a>0?e().translator.trans("huseyinfiliz-awards.forum.other.pending_count",{count:a}):l?e().translator.trans("huseyinfiliz-awards.forum.other.no_remaining"):s?e().translator.trans("huseyinfiliz-awards.forum.other.click_to_suggest"):e().translator.trans("huseyinfiliz-awards.forum.other.remaining",{count:i}))))},r}(E()),$=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r.prototype.view=function(){var t=this.attrs.category,r=this.attrs.award,a=t.nominees()||[],n=a.length,o=t.id(),s=e().store.all("award-votes").filter(function(t){var e,r=(null==t.categoryId?void 0:t.categoryId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.category)||null==(e=e.data)?void 0:e.id);return String(r)===String(o)}).length,i=parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10),l=r.isVotingOpen()&&e().session.user&&s>0;return m("div",{className:"CategoryCard",id:"category-"+t.id()},m("div",{className:"CategoryCard-header"},m("div",{className:"CategoryCard-headerMain"},m("h2",null,t.name()),t.description()?m("p",null,t.description()):null),m("div",{className:"CategoryCard-badges"},l?m("div",{className:"CategoryCard-voteBadge"},m("i",{className:"fas fa-check"}),0===i?e().translator.trans("huseyinfiliz-awards.forum.category.votes_unlimited",{count:s}):e().translator.trans("huseyinfiliz-awards.forum.category.votes_used",{used:s,limit:i})):null,n>0?m("div",{className:"CategoryCard-badge"},e().translator.trans("huseyinfiliz-awards.forum.category.nominees_count",{count:n})):null)),m("div",{className:"CategoryCard-grid"},a.map(function(e){return m(D,{nominee:e,category:t,award:r})}),t.allowOther()&&r.isVotingOpen()&&e().session.user?m(Y,{category:t}):null),0!==a.length||t.allowOther()?null:m("div",{className:"EmptyState"},m("p",null,e().translator.trans("huseyinfiliz-awards.forum.empty.no_nominees"))))},r}(E());function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}var K=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).currentCategoryIndex=0,e.showConfetti=!1,e.confettiShown=!1,e}d(r,t);var a=r.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.checkCompletion()},a.onupdate=function(e){t.prototype.onupdate.call(this,e),this.checkCompletion()},a.checkCompletion=function(){var t=this,e=this.attrs.votedCount,r=this.attrs.totalCount;e===r&&r>0&&!this.confettiShown&&(this.showConfetti=!0,this.confettiShown=!0,setTimeout(function(){t.showConfetti=!1,m.redraw()},4e3))},a.view=function(){var t=this,r=this.attrs.votedCount,a=this.attrs.totalCount,n=this.attrs.categoryIds,o=this.attrs.onNavigate,s=this.attrs.selectedCategoryId,i=this.attrs.onCategoryChange,l=r===a&&a>0,u=a>0?r/a*100:0;return m("div",{className:"VotingProgressBar "+(l?"VotingProgressBar--complete":"")+" "+(this.showConfetti?"VotingProgressBar--confetti":"")},this.showConfetti?this.renderConfetti():null,m("div",{className:"VotingProgressBar-content"},m("div",{className:"VotingProgressBar-progress"},m("div",{className:"VotingProgressBar-progressTrack"},m("div",{className:"VotingProgressBar-progressFill",style:{width:u+"%"}})),m("span",{className:"VotingProgressBar-text"},l?e().translator.trans("huseyinfiliz-awards.forum.progress.complete"):e().translator.trans("huseyinfiliz-awards.forum.progress.voted",{count:r,total:a}))),m("div",{className:"VotingProgressBar-nav"},m(k(),{className:"Button Button--icon",icon:"fas fa-chevron-left",onclick:function(){return t.navigate(-1,n,o,s,i)},disabled:0===n.length,title:e().translator.trans("huseyinfiliz-awards.forum.progress.prev")},e().translator.trans("huseyinfiliz-awards.forum.progress.prev")),m(k(),{className:"Button Button--icon",icon:"fas fa-chevron-right",onclick:function(){return t.navigate(1,n,o,s,i)},disabled:0===n.length,title:e().translator.trans("huseyinfiliz-awards.forum.progress.next")},e().translator.trans("huseyinfiliz-awards.forum.progress.next")))))},a.navigate=function(t,e,r,a,n){if(0!==e.length){if(a&&n){var o=e.indexOf(a);if(-1===o)return;var s=o+t;return s<0&&(s=e.length-1),s>=e.length&&(s=0),void n(e[s])}for(var i,l=null,u=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return J(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(i=u()).done;){var c=i.value,d=document.getElementById("category-"+c);if(d){var m=d.getBoundingClientRect();if(m.top>=0&&m.top<window.innerHeight/2){l=c;break}}}var f=l?e.indexOf(l):0;-1===f&&(f=0);var h=f+t;h<0&&(h=e.length-1),h>=e.length&&(h=0),r(e[h])}},a.renderConfetti=function(){for(var t=["#ffd700","#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#ffeaa7","#dfe6e9"],e=[],r=0;r<30;r++){var a=t[Math.floor(Math.random()*t.length)],n=100*Math.random(),o=.5*Math.random(),s=6+6*Math.random(),i=360*Math.random();e.push(m("div",{key:r,className:"VotingProgressBar-confettiPiece",style:{left:n+"%",animationDelay:o+"s",backgroundColor:a,width:s+"px",height:s+"px",transform:"rotate("+i+"deg)"}}))}return m("div",{className:"VotingProgressBar-confettiContainer"},e)},r}(E()),Q=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var a=r.prototype;return a.getVotedCategoryIds=function(t){var r=e().store.all("award-votes"),a=[];return t.forEach(function(t){var e=t.id();r.some(function(t){var r,a=(null==t.categoryId?void 0:t.categoryId())||(null==(r=t.data)||null==(r=r.relationships)||null==(r=r.category)||null==(r=r.data)?void 0:r.id);return String(a)===String(e)})&&a.push(String(e))}),a},a.view=function(){var t=this.attrs.award,r=this.attrs.selectedCategoryId,a=this.attrs.onCategoryChange,n=t.categories()||[],o=r?n.filter(function(t){return String(t.id())===r}):n,s=this.getVotedCategoryIds(n),i=n.length,l=s.length,u=n.map(function(t){return String(t.id())});return m("div",{className:"VotingView"},m("div",{className:"VotingView-content"},0===o.length?m("div",{className:"EmptyState"},m("p",null,e().translator.trans("huseyinfiliz-awards.forum.empty.no_categories"))):o.map(function(e){return m($,{category:e,award:t})})),t.isVotingOpen()&&e().session.user?m(K,{votedCount:l,totalCount:i,categoryIds:u,selectedCategoryId:r,onCategoryChange:a,onNavigate:function(t){var e=document.getElementById("category-"+t);e&&e.scrollIntoView({behavior:"smooth",block:"start"})}}):null)},r}(E()),X=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var a=r.prototype;return a.className=function(){return"HFAwardsModal CategoryResultsModal"},a.title=function(){var t=this.attrs.category;return m("span",null,t.name()," - ",e().translator.trans("huseyinfiliz-awards.forum.results.full_results"))},a.content=function(){var t=this.attrs.category,e=this.attrs.award,r=t.nominees()||[],a=[].concat(r).sort(function(t,e){return(e.voteCount()||0)-(t.voteCount()||0)}),n=a.reduce(function(t,e){return t+(e.voteCount()||0)},0),o=e.canShowVotes();return m("div",{className:"Modal-body"},m("div",{className:"CategoryResultsModal-list"},a.map(function(t,e){var r=t.voteCount()||0,a=n>0?Math.round(r/n*100):0,s=0===e,i=1===e,l=2===e;return m("div",{className:"CategoryResultsModal-item "+(s?"CategoryResultsModal-item--winner":""),key:t.id()},m("div",{className:"CategoryResultsModal-item-rank"},s?m("span",{className:"CategoryResultsModal-medal CategoryResultsModal-medal--gold"},m("i",{className:"fas fa-medal"})):i?m("span",{className:"CategoryResultsModal-medal CategoryResultsModal-medal--silver"},m("i",{className:"fas fa-medal"})):l?m("span",{className:"CategoryResultsModal-medal CategoryResultsModal-medal--bronze"},m("i",{className:"fas fa-medal"})):m("span",{className:"CategoryResultsModal-rankNumber"},e+1)),m("div",{className:"CategoryResultsModal-item-nominee"},t.imageUrl()?m("img",{className:"CategoryResultsModal-item-image",src:t.imageUrl(),alt:t.name()}):m("div",{className:"CategoryResultsModal-item-placeholder"},m("i",{className:"fas fa-user"})),m("span",{className:"CategoryResultsModal-item-name"},t.name())),o?m("div",{className:"CategoryResultsModal-item-stats"},m("span",{className:"CategoryResultsModal-item-votes"},r),m("div",{className:"CategoryResultsModal-item-bar"},m("div",{className:"CategoryResultsModal-item-barFill",style:{width:a+"%"}})),m("span",{className:"CategoryResultsModal-item-percentage"},a,"%")):null)})))},r}(F()),Z=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r.prototype.view=function(){var t=this.attrs.category,r=this.attrs.award,a=t.nominees()||[],n=[].concat(a).sort(function(t,e){return(e.voteCount()||0)-(t.voteCount()||0)}).slice(0,3),o=r.canShowVotes(),s=a.length>3;return m("div",{className:"CategoryCard CategoryResultCard",id:"category-"+t.id()},m("div",{className:"CategoryCard-header"},m("div",{className:"CategoryCard-headerMain"},m("h2",null,t.name()),t.description()?m("p",null,t.description()):null),s?m(k(),{className:"Button Button--text CategoryResultCard-viewAll",onclick:function(){e().modal.show(X,{category:t,award:r})}},e().translator.trans("huseyinfiliz-awards.forum.results.view_all")):null),m("div",{className:"CategoryCard-grid"},n.map(function(t,r){var a=0===r,n=1===r,s=2===r;return m("div",{className:"NomineeCard "+(a?"NomineeCard--winner":""),key:t.id()},m("div",{className:"NomineeCard-image"},t.imageUrl()?m("img",{src:t.imageUrl(),alt:t.name()}):m("div",{className:"NomineeCard-placeholder"},m("i",{className:"fas fa-user"})),a?m("div",{className:"NomineeCard-badge NomineeCard-badge--gold"},m("i",{className:"fas fa-medal"})):null,n?m("div",{className:"NomineeCard-badge NomineeCard-badge--silver"},m("i",{className:"fas fa-medal"})):null,s?m("div",{className:"NomineeCard-badge NomineeCard-badge--bronze"},m("i",{className:"fas fa-medal"})):null),m("div",{className:"NomineeCard-content"},m("h3",{className:"NomineeCard-title"},t.name()),t.description()?m("p",{className:"NomineeCard-description"},t.description()):null,a?m("div",{className:"TagLabel Label--success"},e().translator.trans("huseyinfiliz-awards.forum.results.winner")):null,n?m("div",{className:"TagLabel Label--info"},e().translator.trans("huseyinfiliz-awards.forum.results.runner_up")):null,o?m("div",{className:"NomineeCard-stats"},m("span",{className:"NomineeCard-votes"},e().translator.trans("huseyinfiliz-awards.forum.results.votes",{count:t.voteCount()})),m("span",{className:"NomineeCard-percentage"},e().translator.trans("huseyinfiliz-awards.forum.results.percentage",{percent:t.votePercentage()}))):null))})))},r}(E()),tt=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).showDetails=!1,e}d(r,t);var a=r.prototype;return a.getPredictionResults=function(t,r){var a=e().store.all("award-votes"),n=[];return r.forEach(function(t){var e=t.id(),r=t.nominees()||[],o=a.find(function(t){var r,a=(null==t.categoryId?void 0:t.categoryId())||(null==(r=t.data)||null==(r=r.relationships)||null==(r=r.category)||null==(r=r.data)?void 0:r.id);return String(a)===String(e)}),s=null;if(o){var i,l=(null==o.nomineeId?void 0:o.nomineeId())||(null==(i=o.data)||null==(i=i.relationships)||null==(i=i.nominee)||null==(i=i.data)?void 0:i.id);s=r.find(function(t){return String(t.id())===String(l)})||null}var u=r.length>0?r.reduce(function(t,e){return(e.voteCount()||0)>(t.voteCount()||0)?e:t}):null,c=s&&u&&String(s.id())===String(u.id());n.push({category:t,userVotedNominee:s,winner:u,isCorrect:!!c})}),n},a.view=function(){var t=this,r=this.attrs.award,a=this.attrs.categories,n=this.getPredictionResults(r,a).filter(function(t){return null!==t.userVotedNominee});if(0===n.length)return null;var o=n.filter(function(t){return t.isCorrect}).length,s=n.length,i=s>0?o/s*100:0,l=n.filter(function(t){return t.isCorrect}),u=n.filter(function(t){return!t.isCorrect});return m("div",{className:"PredictionSummary"},m("div",{className:"PredictionSummary-header"},m("i",{className:"fas fa-bullseye"}),m("h3",null,e().translator.trans("huseyinfiliz-awards.forum.prediction.title"))),m("div",{className:"PredictionSummary-content"},m("div",{className:"PredictionSummary-progress"},m("div",{className:"PredictionSummary-progressTrack"},m("div",{className:"PredictionSummary-progressFill",style:{width:i+"%"}})),m("span",{className:"PredictionSummary-score"},e().translator.trans("huseyinfiliz-awards.forum.prediction.score",{correct:o,total:s}))),m("button",{className:"PredictionSummary-toggle",onclick:function(){t.showDetails=!t.showDetails,m.redraw()}},this.showDetails?m("span",null,m("i",{className:"fas fa-chevron-up"})," Hide details"):m("span",null,m("i",{className:"fas fa-chevron-down"})," Show details")),this.showDetails?m("div",{className:"PredictionSummary-details"},l.length>0?m("div",{className:"PredictionSummary-section PredictionSummary-section--correct"},m("span",{className:"PredictionSummary-section-label"},m("i",{className:"fas fa-check"})," ",e().translator.trans("huseyinfiliz-awards.forum.prediction.correct")),m("div",{className:"PredictionSummary-categories"},l.map(function(t){return m("span",{key:t.category.id(),className:"PredictionSummary-category"},t.category.name())}))):null,u.length>0?m("div",{className:"PredictionSummary-section PredictionSummary-section--wrong"},m("span",{className:"PredictionSummary-section-label"},m("i",{className:"fas fa-times"})," ",e().translator.trans("huseyinfiliz-awards.forum.prediction.wrong")),m("div",{className:"PredictionSummary-categories"},u.map(function(t){return m("span",{key:t.category.id(),className:"PredictionSummary-category"},t.category.name())}))):null):null))},r}(E()),et=function(t){function r(){return t.apply(this,arguments)||this}return d(r,t),r.prototype.view=function(){var t=this.attrs.award,r=this.attrs.selectedCategoryId,a=t.categories()||[],n=r?a.filter(function(t){return String(t.id())===r}):a;return m("div",{className:"ResultsView"},e().session.user&&!r?m(tt,{award:t,categories:a}):null,m("div",{className:"ResultsView-content"},0===n.length?m("div",{className:"EmptyState"},m("p",null,e().translator.trans("huseyinfiliz-awards.forum.empty.no_categories"))):n.map(function(e){return m(Z,{category:e,award:t})})))},r}(E());const rt=flarum.core.compat["common/helpers/humanTime"];var at=r.n(rt),nt=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).expandUnvoted=!0,e.removingVotes=new Set,e}d(r,t);var a=r.prototype;return a.getVotesInfo=function(t){var r=t.categories()||[],a=e().store.all("award-votes"),n=parseInt(e().forum.attribute("awardsVotesPerCategory")||"1",10),o=[],s=[],i=null,l=0;return r.forEach(function(t){var e=t.id(),r=t.nominees()||[],u=a.filter(function(t){var r,a=(null==t.categoryId?void 0:t.categoryId())||(null==(r=t.data)||null==(r=r.relationships)||null==(r=r.category)||null==(r=r.data)?void 0:r.id);return String(a)===String(e)});if(u.length>0){var c=[];if(u.forEach(function(t){var e,a=(null==t.nomineeId?void 0:t.nomineeId())||(null==(e=t.data)||null==(e=e.relationships)||null==(e=e.nominee)||null==(e=e.data)?void 0:e.id),n=r.find(function(t){return String(t.id())===String(a)});if(n){c.push({nominee:n,vote:t}),l++;var o=null==t.createdAt?void 0:t.createdAt();o&&(!i||o>i)&&(i=o)}}),c.length>0){var d=0===n||c.length<n;o.push({category:t,votes:c,votesLimit:n,canAddMore:d})}}else s.push(t)}),{votedCategories:o,unvoted:s,lastVoteTime:i,totalVotes:l}},a.removeVote=function(t,r){var a=this,n=String(t.id());this.removingVotes.has(n)||(this.removingVotes.add(n),m.redraw(),t.delete().then(function(){var t=(null==r.voteCount?void 0:r.voteCount())||0;t>0&&r.pushData({attributes:{voteCount:t-1}}),e().alerts.show({type:"success"},e().translator.trans("huseyinfiliz-awards.forum.voting.vote_removed")),a.removingVotes.delete(n),m.redraw()}).catch(function(t){throw a.removingVotes.delete(n),m.redraw(),t}))},a.view=function(){var t=this,r=this.attrs.award,a=this.attrs.onNavigateToCategory,n=r.categories()||[],o=r.isVotingOpen(),s=this.getVotesInfo(r),i=s.votedCategories,l=s.unvoted,u=s.lastVoteTime,c=s.totalVotes,d=n.length,f=i.length;return m("div",{className:"MyVotesView"},m("div",{className:"MyVotesView-summary"},m("div",{className:"MyVotesView-summary-content"},m("div",{className:"MyVotesView-summary-stats"},m("span",{className:"MyVotesView-summary-count"},e().translator.trans("huseyinfiliz-awards.forum.my_votes.summary",{voted:f,total:d})),m("span",{className:"MyVotesView-summary-totalVotes"},e().translator.trans("huseyinfiliz-awards.forum.my_votes.total_votes",{count:c})),u?m("span",{className:"MyVotesView-summary-time"},e().translator.trans("huseyinfiliz-awards.forum.my_votes.last_vote",{time:at()(u)})):null),m("div",{className:"MyVotesView-summary-progress"},m("div",{className:"MyVotesView-summary-progressBar",style:{width:(d>0?f/d*100:0)+"%"}})))),i.length>0?m("div",{className:"MyVotesView-section"},m("h3",{className:"MyVotesView-section-title"},e().translator.trans("huseyinfiliz-awards.forum.my_votes.title")),m("div",{className:"MyVotesView-list"},i.map(function(r){var n=r.category,s=r.votes,i=r.votesLimit,l=r.canAddMore;return m("div",{className:"MyVotesView-categoryGroup",key:n.id()},m("div",{className:"MyVotesView-categoryHeader"},m("span",{className:"MyVotesView-categoryName"},n.name()),m("span",{className:"MyVotesView-categoryVoteCount"},0===i?e().translator.trans("huseyinfiliz-awards.forum.my_votes.votes_unlimited",{count:s.length}):e().translator.trans("huseyinfiliz-awards.forum.my_votes.votes_used",{used:s.length,limit:i}))),s.map(function(r){var a=r.nominee,n=r.vote;return m("div",{className:"MyVotesView-item",key:n.id()},m("div",{className:"MyVotesView-item-nominee"},a.imageUrl()?m("img",{className:"MyVotesView-item-image",src:a.imageUrl(),alt:a.name()}):m("div",{className:"MyVotesView-item-placeholder"},m("i",{className:"fas fa-user"}))),m("div",{className:"MyVotesView-item-info"},m("div",{className:"MyVotesView-item-name"},a.name())),m("div",{className:"MyVotesView-item-meta"},null!=n.createdAt&&n.createdAt()?m("span",{className:"MyVotesView-item-date"},at()(n.createdAt())):null),m("div",{className:"MyVotesView-item-actions"},o?m(k(),{className:"Button Button--text Button--danger",onclick:function(){return t.removeVote(n,a)},loading:t.removingVotes.has(String(n.id()))},e().translator.trans("huseyinfiliz-awards.forum.my_votes.remove")):null))}),o&&l?m("div",{className:"MyVotesView-addMore"},m(k(),{className:"Button Button--text",icon:"fas fa-plus",onclick:function(){return a(String(n.id()))}},e().translator.trans("huseyinfiliz-awards.forum.my_votes.add_vote"))):null)}))):m("div",{className:"MyVotesView-empty"},m("i",{className:"fas fa-vote-yea"}),m("p",null,e().translator.trans("huseyinfiliz-awards.forum.my_votes.no_votes"))),l.length>0?m("div",{className:"MyVotesView-section MyVotesView-section--unvoted"},m("button",{className:"MyVotesView-section-header",onclick:function(){t.expandUnvoted=!t.expandUnvoted,m.redraw()}},m("h3",{className:"MyVotesView-section-title"},e().translator.trans("huseyinfiliz-awards.forum.my_votes.categories_remaining"),m("span",{className:"MyVotesView-section-count"},"(",l.length,")")),m("i",{className:"fas fa-chevron-"+(this.expandUnvoted?"up":"down")})),this.expandUnvoted?m("div",{className:"MyVotesView-unvotedList"},l.map(function(t){return m("div",{className:"MyVotesView-unvotedItem",key:t.id()},m("span",{className:"MyVotesView-unvotedItem-name"},t.name()),m(k(),{className:"Button Button--primary Button--small",onclick:function(){return a(String(t.id()))}},e().translator.trans("huseyinfiliz-awards.forum.my_votes.vote_now")))})):null):null)},r}(E()),ot=function(t){function r(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this).loading=!0,e.awards=[],e.selectedAward=null,e.selectedCategoryId=null,e.currentView="categories",e.countdownInterval=null,e.countdownText="",e.refreshInterval=null,e.routeAwardId=null,e.routeCategoryId=null,e}d(r,t);var a=r.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e);var r=m.route.param("id"),a=m.route.param("category");if(r){var n=r.match(/^(\d+)/);this.routeAwardId=n?n[1]:null}a&&(this.routeCategoryId=a),this.loadAwards()},a.oncreate=function(r){t.prototype.oncreate.call(this,r);var a=e().forum.attribute("awardsNavTitle")||"Awards";e().setTitle(R()(a)),this.startCountdown()},a.onremove=function(e){t.prototype.onremove.call(this,e),this.countdownInterval&&clearInterval(this.countdownInterval),this.stopAutoRefresh()},a.startCountdown=function(){var t=this;this.updateCountdown(),this.countdownInterval=window.setInterval(function(){t.updateCountdown(),m.redraw()},1e3)},a.updateCountdown=function(){if(this.selectedAward){var t=this.selectedAward.endsAt();if(t){var r=new Date,a=t.getTime()-r.getTime();if(a<=0)this.countdownText=e().translator.trans("huseyinfiliz-awards.forum.hero.voting_ended");else{var n=Math.floor(a/864e5),o=Math.floor(a%864e5/36e5),s=Math.floor(a%36e5/6e4),i="";n>0&&(i+=n+"d "),(o>0||n>0)&&(i+=o+"h "),(s>0||o>0||n>0)&&(i+=s+"m "),i+=Math.floor(a%6e4/1e3)+"s",this.countdownText=e().translator.trans("huseyinfiliz-awards.forum.hero.countdown",{time:i})}}else this.countdownText=""}else this.countdownText=""},a.loadAwards=function(){var t=b(A().mark(function t(){var r,a,n,o,s,i=this;return A().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,m.redraw(),t.prev=1,t.next=2,e().store.find("awards",{include:"categories,categories.nominees"});case 2:if(a=t.sent,this.awards=(a||[]).filter(function(t){return t.isActive()||t.isPublished()||t.hasEnded()}),this.routeAwardId&&(this.selectedAward=this.awards.find(function(t){return String(t.id())===i.routeAwardId})||null),this.selectedAward||(this.selectedAward=this.awards.find(function(t){return t.isActive()})||this.awards.find(function(t){return t.isPublished()})||this.awards[0]||null),null!=(r=this.selectedAward)&&r.canViewResults()?this.currentView="results":this.currentView="categories",this.routeCategoryId&&this.selectedAward&&(((null==(n=(o=this.selectedAward).categories)?void 0:n.call(o))||[]).some(function(t){return String(t.id())===i.routeCategoryId})&&(this.selectedCategoryId=this.routeCategoryId)),!e().session.user){t.next=3;break}return t.next=3,this.loadUserVotes();case 3:t.next=5;break;case 4:t.prev=4,s=t.catch(1),console.error("Failed to load awards:",s);case 5:this.loading=!1,this.startAutoRefresh(),this.updateUrl(),m.redraw(),this.routeCategoryId&&this.selectedCategoryId&&setTimeout(function(){return i.scrollToCategory(i.routeCategoryId)},100);case 6:case"end":return t.stop()}},t,this,[[1,4]])}));return function(){return t.apply(this,arguments)}}(),a.startAutoRefresh=function(){var t=this;this.selectedAward&&this.selectedAward.isVotingOpen()&&this.selectedAward.showLiveVotes()&&(this.stopAutoRefresh(),this.refreshInterval=window.setInterval(function(){t.refreshVoteCounts()},6e4))},a.stopAutoRefresh=function(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null)},a.refreshVoteCounts=function(){var t=b(A().mark(function t(){var r;return A().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.selectedAward){t.next=1;break}return t.abrupt("return");case 1:return t.prev=1,t.next=2,e().store.find("awards",this.selectedAward.id(),{include:"categories,categories.nominees"});case 2:m.redraw(),t.next=4;break;case 3:t.prev=3,r=t.catch(1),console.error("Failed to refresh vote counts:",r);case 4:case"end":return t.stop()}},t,this,[[1,3]])}));return function(){return t.apply(this,arguments)}}(),a.loadUserVotes=function(){var t=b(A().mark(function t(){var r;return A().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,e().store.find("award-votes");case 1:t.next=3;break;case 2:t.prev=2,r=t.catch(0),console.error("Failed to load user votes:",r);case 3:case"end":return t.stop()}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),a.view=function(){var t=e().forum.attribute("awardsNavTitle")||"Awards",r=e().forum.attribute("awardsNavIcon")||"fas fa-trophy";return m("div",{className:"IndexPage huseyinfiliz-awards"},this.hero(t,r),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,B()(o().prototype.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},this.loading?m(M(),null):this.content()))))},a.hero=function(t,r){var a,n=null==(a=this.selectedAward)||null==a.imageUrl?void 0:a.imageUrl(),o=n&&n.length>0;return m("header",{className:"Hero AwardsHero "+(o?"AwardsHero--withImage":""),style:o?{backgroundImage:"url("+n+")"}:void 0},o?m("div",{className:"AwardsHero-overlay"}):null,m("div",{className:"container"},m("div",{className:"containerNarrow"},m("h1",{className:"Hero-title"},m("i",{className:"icon "+r})," ",t),this.selectedAward?m("div",{className:"Hero-subtitle"},this.selectedAward.description()):null,this.selectedAward&&this.selectedAward.isVotingOpen()&&this.countdownText?m("div",{className:"AwardsHero-countdown"},m("i",{className:"fas fa-clock"})," ",this.countdownText):null,this.selectedAward&&!this.selectedAward.isVotingOpen()&&this.selectedAward.hasEnded()&&!this.selectedAward.isPublished()?m("div",{className:"AwardsHero-countdown AwardsHero-countdown--ended"},e().translator.trans("huseyinfiliz-awards.forum.hero.voting_ended")):null,this.selectedAward&&this.selectedAward.isPublished()?m("div",{className:"AwardsHero-countdown AwardsHero-countdown--published"},e().translator.trans("huseyinfiliz-awards.forum.hero.results_published")):null)))},a.content=function(){var t=e().forum.attribute("awardsNavIcon")||"fas fa-trophy";return 0===this.awards.length?m("div",{className:"EmptyState"},m("i",{className:t}),m("h2",null,e().translator.trans("huseyinfiliz-awards.forum.empty.no_awards")),m("p",null,e().translator.trans("huseyinfiliz-awards.forum.empty.no_awards_description"))):m("div",{className:"AwardsPage-content"},this.renderFilterBar(),this.renderAwardView())},a.renderFilterBar=function(){var t,r,a=this,n=(null==(t=this.selectedAward)||null==t.categories?void 0:t.categories())||[],o=null==(r=this.selectedAward)?void 0:r.isPublished(),s=e().session.user,i={all:e().translator.trans("huseyinfiliz-awards.forum.nav.all_categories")};return n.forEach(function(t){i["cat_"+t.id()]=t.name()}),m("div",{className:"AwardsPage-filterBar"},m("div",{className:"AwardsPage-filterBar-left"},this.awards.length>1?this.renderAwardSelector():null,n.length>0&&"my_votes"!==this.currentView?m("div",{className:"AwardsPage-categoryFilter"},m(P(),{value:this.selectedCategoryId?"cat_"+this.selectedCategoryId:"all",options:i,onchange:function(t){a.selectedCategoryId="all"===t?null:t.replace("cat_",""),a.updateUrl(),m.redraw()}})):null),m("div",{className:"AwardsPage-filterBar-right"},m("div",{className:"AwardsPage-tabs"},m(k(),{className:"Button "+("categories"===this.currentView||"results"===this.currentView&&!o?"Button--primary":""),onclick:function(){a.currentView=o?"results":"categories",m.redraw()}},o?e().translator.trans("huseyinfiliz-awards.forum.tabs.results"):e().translator.trans("huseyinfiliz-awards.forum.tabs.categories")),s?m(k(),{className:"Button "+("my_votes"===this.currentView?"Button--primary":""),onclick:function(){a.currentView="my_votes",m.redraw()},icon:"fas fa-clipboard-list"},e().translator.trans("huseyinfiliz-awards.forum.tabs.my_votes")):null)))},a.renderAwardSelector=function(){var t,e=this,r={};return this.awards.forEach(function(t){r[String(t.id())]=t.name()+" ("+t.year()+")"}),m("div",{className:"AwardsPage-selector"},m(P(),{value:String(null==(t=this.selectedAward)?void 0:t.id()),options:r,onchange:function(t){var r;e.selectedAward=e.awards.find(function(e){return String(e.id())===t})||null,e.selectedCategoryId=null,null!=(r=e.selectedAward)&&r.canViewResults()?e.currentView="results":e.currentView="categories",e.updateUrl(),m.redraw()}}))},a.scrollToCategory=function(t){if(t){var e=document.getElementById("category-"+t);e&&e.scrollIntoView({behavior:"smooth",block:"start"})}},a.updateUrl=function(){if(this.selectedAward){var t,r=this.selectedAward.id(),a=this.selectedAward.slug()||"award";t=this.selectedCategoryId?e().route("awards.category",{id:r+"-"+a,category:this.selectedCategoryId}):e().route("awards.show",{id:r+"-"+a}),history.replaceState(null,"",t)}},a.renderAwardView=function(){var t=this,r=this.selectedAward;return"my_votes"===this.currentView&&e().session.user?m(nt,{award:r,onNavigateToCategory:function(e){t.currentView="categories",t.selectedCategoryId=e,t.updateUrl(),m.redraw(),setTimeout(function(){return t.scrollToCategory(e)},100)}}):r.canViewResults()?m(et,{award:r,selectedCategoryId:this.selectedCategoryId}):r.isActive()||r.hasEnded()?m(Q,{award:r,selectedCategoryId:this.selectedCategoryId,onCategoryChange:function(e){t.selectedCategoryId=e,t.updateUrl(),m.redraw()}}):m("div",{className:"EmptyState"},m("p",null,e().translator.trans("huseyinfiliz-awards.forum.error.not_available")))},r}(x());const st=flarum.core.compat["forum/components/Notification"];var it=function(t){function r(){return t.apply(this,arguments)||this}d(r,t);var a=r.prototype;return a.icon=function(){return"fas fa-trophy"},a.href=function(){var t=this.attrs.notification.content()||{},r=t.awardId,a=t.awardSlug||"award";return r?e().route("awards.show",{id:r+"-"+a}):e().route("awards")},a.content=function(){var t=(this.attrs.notification.content()||{}).awardName||"Awards";return e().translator.trans("huseyinfiliz-awards.forum.notification.results_published",{awardName:t})},a.excerpt=function(){return null},r}(r.n(st)());e().initializers.add("huseyinfiliz/awards",function(){N.forEach(function(t){return t.extend(e())}),e().routes.awards={path:"/awards",component:ot},e().routes["awards.show"]={path:"/awards/:id",component:ot},e().routes["awards.category"]={path:"/awards/:id/:category",component:ot},e().notificationComponents.awardsResultsPublished=it,(0,a.extend)(o().prototype,"navItems",function(t){if(!1!==e().forum.attribute("canViewAwards")){var r=e().forum.attribute("awardsNavTitle")||"Awards",a=e().forum.attribute("awardsNavIcon")||"fas fa-trophy";t.add("awards",i().component({href:e().route("awards"),icon:a},r),85)}})})})(),module.exports={}})();
//# sourceMappingURL=forum.js.map